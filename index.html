
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Polyglot</title>
  <meta name="author" content="Mark Fussell">

  
  <meta name="description" content="This is the second in a series of using git as part of interesting solutions to problems. The first is here: Intro Dealing with Binary Files As &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://markfussell.github.com/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Polyglot" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Polyglot</a></h1>
  
    <h2>Wants a cracker</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:markfussell.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/13/git-about-everything-annex/">Being a Git About Everything (Annexing)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-13T18:16:00-08:00" pubdate data-updated="true">Jan 13<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is the second in a series of using git as part of interesting solutions to problems.</p>

<p>The first is here: <a href="/blog/2013/01/11/git-about-everything-intro/">Intro</a></p>

<h2>Dealing with Binary Files</h2>

<p>As mentioned in the first posting, git and similar DVCS have issues with binary files.  Adding 100s of 10MB files, or 100s of
versions of 10MB files will produce gigabytes worth of data that must be cloned by everyone using the repository.  How do we avoid this?</p>

<p>There are a number of solutions in this space out there with differing characteristics, but the core approach is usually similar:
&#8220;Don&#8217;t store it in git&#8221;.  Instead we want to record enough information to retrieve the binary files from somewhere else.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2013/01/13/git-about-everything-annex/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/11/git-about-everything-intro/">Being a Git About Everything (Intro)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-11T18:16:00-08:00" pubdate data-updated="true">Jan 11<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There are times when a new technology comes along, that at first appears to be pretty similar to
existing technology, but certain characteristics make for radically different or just nicely new solutions.
A recent example of this is &#8216;git&#8217; and similar distributed version control systems (DVCS).  They may
at first appear to be an interesting version of centralized version/content management systems, but
they are really much more&#8230; a core piece of technology useful for many things.</p>

<p>This is a series about how to use git to solve many different problems, some obvious and some more unusual.
I hope a few of them are interesting to readers.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2013/01/11/git-about-everything-intro/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/09/19/scratchonflash/">Scratch on Flash</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-09-19T18:00:00-07:00" pubdate data-updated="true">Sep 19<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The original version of this posting is on the <a href="http://scratch.mit.edu/forums/viewtopic.php?id=9982">MIT Scratch Forum</a> and the
current location of the repository is <a href="https://github.com/markfussell/scratchonflash">https://github.com/markfussell/scratchonflash</a></p>

<p>In the spirit of release early and often&#8230;</p>

<p>I have made a full bottom-to-top pass at implementing Scratch in Flash.  It can:</p>

<ul>
<li> Read a scratch project file</li>
<li> Create the project model (Stage, Sprites, Blocks, etc.)</li>
<li> Run that model (the core variable assignments, loops, etc.)</li>
<li> And do a couple of the other kinds of Sprite blocks in the &#8216;motion&#8217; and &#8216;looks&#8217; categories</li>
</ul>


</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2008/09/19/scratchonflash/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/09/17/scratch-textual-language/">Scratch Textual Language</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-09-17T20:28:00-07:00" pubdate data-updated="true">Sep 17<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://scratch.mit.edu/">Scratch</a> is a visual programming language, but it might usefully have a textual version as well.  Scratch in it&#8217;s graphical form can verify syntax intuitively &amp; automatically, and the resulting graphics are definitely beautiful, but it took quite some effort to produce <a href="a-taste-of-scratch">these diagrams</a> when trying to document a program, and it is even harder to reference sections of the diagram.</p>

<p>This activity came out of producing a Scratch Player in Flash, and I wanted to see whether the parse of the file produced the correct program.  A textual dump of the parse was an obvious solution, but then this &#8216;dump&#8217; might as well be the same as a complete program declaration so it was clearly &#8216;complete&#8217; and I wasn&#8217;t missing anything.</p>

<h2>Scratch Textual</h2>

<p>The core concepts in this proposed textual language for Scratch are:</p>

<ul>
<li><p>It should match Scratch as closely as possible</p></li>
<li><p>It should be a readable and easily writeable textual language (vs. XML as an interchange format)</p></li>
<li><p>It should be translatable to other human languages for the blocks (as Scratch is)</p></li>
<li><p>It should be really simple to produce and parse</p></li>
<li><p>Given Scratch is graphical, visual indentation is reasonable</p></li>
<li><p>It is not a complete &#8216;dump&#8217; of the Scratch project &#8211; no media resources are included.</p></li>
</ul>


<p>The above concepts produced the following initial choices:</p>

<ul>
<li><p>Different sections start with simple keywords: &#8220;stage:&#8221; and &#8220;sprite:&#8221; for the main objects, &#8220;vars:&#8221; and &#8216;listVars:&#8221; for declaring variables, &#8220;comment:&#8221; for a comment section, and &#8220;script:&#8221; for declaring a sequence of blocks.</p></li>
<li><p>Variables simply define their name and an initial value (if desired&#8230; otherwise it would be &#8216;0&#8217;)</p></li>
<li><p>Each block is written out textually with its &#8216;spec&#8217; &#8211; a human readable description of the block and its parameters</p></li>
<li><p>The parameters to a block (if any) come immediately after, and are preferably indented [say 4 spaces] from the block they are parameters too.  Note that the indentation is not necessary because you can tell the number of parameters from the block &#8216;spec&#8217;, but indenting makes it more readable.</p></li>
<li><p>If a block can contain other blocks, contained blocks <em>must be</em> indented [say 4 spaces] so you can tell they are inside the block vs. after the block.  This is in a fashion similar to Python.</p></li>
<li><p>There should be no blank line within a &#8216;script:&#8217; section.  The end of a script: section is the first blank (non-comment) line.</p></li>
<li><p>Comments within the textual blocks use &#8216;#&#8217; to match with Python.  Multi-line comments do not exist.  Note that Textual Comments are not parsed at all (and do not round-trip), so they should be minimal and merely augment parsing the textual source &#8211; use &#8216;comment:&#8217; for real documentation.</p></li>
<li><p>&#8216;script:&#8217; and &#8216;comment:&#8217; could have position information after them using the &#8216;loc&#8217; property (e.g. &#8220;loc = 500@250&#8221;) but this is not likely to be useful since any edits would cause positions to be wrong</p></li>
</ul>


<h3>An Example</h3>

<p>The following is a complete &#8220;normal expanded format&#8221; version.  See further below for a possible optimization to make things more vertically compressed.</p>

<p>[sourcecode language=&#8221;python&#8221;]</p>

<h1>===========================</h1>

<h1>=== Morph: Stage</h1>

<h1>===========================</h1>

<p>stage: Stage</p>

<h1>============</h1>

<h1>=== Vars</h1>

<h1>============</h1>

<p>vars:
talest-pole-height = 6
previous-moved-disk = 0
potential-disk = 1
num-disks = 5
next-disk = 0
base-disk = 0</p>

<p>listVars:
pole-1 = undefined
pole-2 = undefined
moveable-disks = undefined
pole-3 = undefined</p>

<h1>============</h1>

<h1>=== Script</h1>

<h1>============</h1>

<p>script:</p>

<p>when &#8216;find-next-disk&#8217;
set next-disk to %n</p>

<pre><code>0
</code></pre>

<p>broadcast %e and wait</p>

<pre><code>propose-next-disk
</code></pre>

<p>repeat until %b</p>

<pre><code>%n &gt; %n
    next-disk  
    0
set potential-disk to %n
if %b  
    not %b
        %n = %n
            potential-disk  
            previous-moved-disk  
    set next-disk to %n
        potential-disk  
</code></pre>

<p>broadcast %e and wait</p>

<pre><code>move-next-disk
</code></pre>

<h1>============</h1>

<h1>=== Script</h1>

<h1>============</h1>

<p>script:</p>

<p>when &#8216;Scratch-StartClicked&#8217;
set num-disks to %n</p>

<pre><code>5
</code></pre>

<p>set base-disk to %n</p>

<pre><code>%n + %n
    num-disks  
    1
</code></pre>

<p>set next-disk to %n</p>

<pre><code>num-disks  
</code></pre>

<p>repeat until %b</p>

<pre><code>%n &lt; %n
    next-disk  
    1
set next-disk to %n
    %n - %n
        next-disk  
        1
</code></pre>

<p>broadcast %e and wait</p>

<pre><code>initialize
</code></pre>

<p>set previous-moved-disk to %n</p>

<pre><code>0
</code></pre>

<p>set talest-pole-height to %n</p>

<pre><code>0
</code></pre>

<p>repeat until %b</p>

<pre><code>%n &gt; %n
    talest-pole-height  
    num-disks  
broadcast %e and wait
    find-next-disk
set talest-pole-height to %n
if %b  
    %n &gt; %n
        talest-pole-height  
    set talest-pole-height to %n
</code></pre>

<h1>===========================</h1>

<h1>=== Morph: Sprite1</h1>

<h1>===========================</h1>

<p>sprite: Sprite1</p>

<h1>============</h1>

<h1>=== Vars</h1>

<h1>============</h1>

<p>vars:
can-move = 3
am-on-top = 1
disk-id = 1
pole = 3
height = 6
previous-pole = 1
pole-at-start = 1</p>

<h1>============</h1>

<h1>=== Script</h1>

<h1>============</h1>

<p>script:</p>

<p>when &#8216;move-next-disk&#8217;
if %b</p>

<pre><code>%n = %n
    disk-id  
    next-disk  
set previous-moved-disk to %n
    disk-id  
set pole-at-start to %n
    pole  
if %b  
    %b and %b
        not %b
            %b or %b
                %n = %n
                    previous-pole  
                    1
                %n = %n
                    pole  
                    1
        %n &lt; %n
            disk-id  
    set pole to %n
        1
if %b  
    %b and %b
        not %b
            %b or %b
                %n = %n
                    previous-pole  
                    2
                %n = %n
                    pole  
                    2
        %n &lt; %n
            disk-id  
    set pole to %n
        2
if %b  
    %b and %b
        not %b
            %b or %b
                %n = %n
                    previous-pole  
                    3
                %n = %n
                    pole  
                    3
        %n &lt; %n
            disk-id  
    set pole to %n
        3
set previous-pole to %n
    pole-at-start  
if %b  
    %n = %n
        previous-pole  
        1
if %b  
    %n = %n
        previous-pole  
        2
if %b  
    %n = %n
        previous-pole  
        3
if %b  
    %n = %n
        pole  
        1
    set height to %n
if %b  
    %n = %n
        pole  
        2
    set height to %n
if %b  
    %n = %n
        pole  
        3
    set height to %n
</code></pre>

<h1>============</h1>

<h1>=== Script</h1>

<h1>============</h1>

<p>script:</p>

<p>when &#8216;propose-next-disk&#8217;
set am-on-top to %n</p>

<pre><code>0
</code></pre>

<p>set can-move to %n</p>

<pre><code>0
</code></pre>

<p>if %b</p>

<pre><code>%b and %b
    %n = %n
        pole  
        1
    %n = %n
        disk-id  
set am-on-top to %n
    1
</code></pre>

<p>if %b</p>

<pre><code>%b and %b
    %n = %n
        pole  
        2
    %n = %n
        disk-id  
set am-on-top to %n
    1
</code></pre>

<p>if %b</p>

<pre><code>%b and %b
    %n = %n
        pole  
        3
    %n = %n
        disk-id  
set am-on-top to %n
    1
</code></pre>

<p>if %b</p>

<pre><code>%n &gt; %n
    am-on-top  
    0
if %b  
    %b and %b
        not %b
            %b or %b
                %n = %n
                    previous-pole  
                    1
                %n = %n
                    pole  
                    1
        %n &lt; %n
            disk-id  
    set can-move to %n
        1
if %b  
    %b and %b
        not %b
            %b or %b
                %n = %n
                    previous-pole  
                    2
                %n = %n
                    pole  
                    2
        %n &lt; %n
            disk-id  
    set can-move to %n
        2
if %b  
    %b and %b
        not %b
            %b or %b
                %n = %n
                    previous-pole  
                    3
                %n = %n
                    pole  
                    3
        %n &lt; %n
            disk-id  
    set can-move to %n
        3
if %b  
    %n &gt; %n
        can-move  
        0
</code></pre>

<h1>============</h1>

<h1>=== Script</h1>

<h1>============</h1>

<p>script:</p>

<p>when &#8216;initialize&#8217;
set disk-id to %n</p>

<pre><code>1
</code></pre>

<p>set pole to %n</p>

<pre><code>1
</code></pre>

<p>set previous-pole to %n</p>

<pre><code>0
</code></pre>

<p>set can-move to %n</p>

<pre><code>0
</code></pre>

<p>set am-on-top to %n</p>

<pre><code>0
</code></pre>

<p>set height to %n</p>

<pre><code>%n + %n
    %n - %n
        base-disk  
        disk-id  
    1
</code></pre>

<p>[/sourcecode]</p>

<h3>Vertical Compression</h3>

<p>The format above has every block on its own line.  This is readable and informative (you can see the argument types) but is vertically expansive.  Assuming parentheses or some other paired delimiter are not used for anything else in names, we could replace the argument placeholders with parentheses like below.  This gives a more lisp-like feel, at least for the inner evaluations.  If you leave one or more placeholders off, they would come from the next lines in &#8216;missing&#8217; order, kind of like a macro.</p>

<p>[sourcecode language=&#8221;python&#8221;]
script:</p>

<p>when &#8216;find-next-disk&#8217;
set next-disk to (0)
broadcast (propose-next-disk) and wait
repeat until ((next-disk) > (0))</p>

<pre><code>set potential-disk to (0)
if (not ( (potential-disk) = (previous-moved-disk)) )
    set next-disk to (potential-disk)
</code></pre>

<p>broadcast (move-next-disk) and wait</p>

<p>[/sourcecode]</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/09/08/a-taste-of-scratch/">A Taste of Scratch</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-09-08T04:15:00-07:00" pubdate data-updated="true">Sep 8<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>One of my favored books in the 1980s was ‘A Taste of Smalltalk’. This was a very short book that gave you the flavor of Smalltalk programming (the language and IDE) as compared to Pascal, C, and Lisp. I believe it is always important to show multiple programming languages for concepts and this book followed that rule. The goal of this post-series is to take ‘A Taste of Smalltalk’ and apply it to Scratch (a visual programming language).  This is the third of my comparisons in this series, where the first one was in Ruby.</p>

<p>You can find the original book here:</p>

<ul>
<li><p><a href="http://www.iam.unibe.ch/~ducasse/FreeBooks/Taste/">A Taste of Smalltalk</a></p></li>
<li><p><a href="http://stephane.ducasse.free.fr/FreeBooks.html">Free Smalltalk Books</a></p></li>
</ul>


<p>Given the original book is available online, I will not repeat it.</p>

<p>You can both see the example in Scratch and get tools and background on the Scratch project at:
<a href="http://scratch.mit.edu/projects/parseroo/260752">Tower of Hanoi</a>.  The scratch tools and the community web site are free.</p>

<h2>Tower of Hanoi &#8211; Object-Oriented (V4) &#8211; Scratch</h2>

<p>The standard pattern for this series is to translate as closely as possible each of the chapters in &#8220;A Taste of Smalltalk&#8221; to the new target language.  This worked reasonably well for Ruby and Flex &#8211; the Smalltalk was translated and interesting features of the language came out with each translation.  But this approach utterly fails for Scratch because the first two &#8216;models&#8217; of the Hanoi algorithm are completely dependent on recursion, which Scratch does not have.  Even the third, stack-less version of Hanoi requires inter-object calls that Scratch can not handle.  So <em>none</em> of the algorithms within &#8220;A Taste of Smalltalk&#8221; can be directly translated to Scratch.</p>

<p>This might appear to be a limitation of the language (and in some ways it certainly is), but somewhat impressively, I believe thinking about this problem, with the restrictions of Scratch, actually leads to a better design solution than any of the ones in the book.  It is certainly a very object-oriented solution, where the &#8216;Hanoi Disks&#8217; have a lot of intelligence and are made as responsible as possible for figuring out what to do next.  This version of the algorithm, I will call &#8216;V4&#8217;.</p>

<h3>The V4 Algorithm</h3>

<p>The V4 Algorithm works as follows:</p>

<ol>
<li><p>Ask each of the disks whether they have a legal move</p></li>
<li><p>Decide which of the disks with a legal move should move</p></li>
<li><p>Tell that disk to move</p></li>
</ol>


<p>The interesting parts of this algorithm are that:</p>

<ul>
<li><p>Step 1 can be completely parallel.  You can ask 1 to 1000000 disks at the same moment whether they have a legal move.</p></li>
<li><p>Step 2 is really trivial: just don&#8217;t move the same disk you did last time</p></li>
</ul>


<p>Compared to the V3 version, the V4 version puts more intelligence in the disks (and less in the tower), couples them less, and supports mass parallel-execution.  The parallel-execution is not useful in Hanoi, but the concepts behind it are definitely very interesting &#8211; and Scratch&#8217;s restrictions forces this kind of &#8216;sophisticated&#8217; approach [or at least it forced me down this path to maintain code-sanity and maintainability].</p>

<h3>The main Scratch Player view</h3>

<p>Scratch is designed to be an easy-to-learn language and environment.  Its heritage is along the lines of the spirit of Logo: there is a Stage drawing area and a default Sprite (a Cat) that you interact with for animation and drawing.  But this Stage can also show the variables involved with the program.  So it produces a nice overview of the whole Hanoi program:</p>

<p><a href="http://chimu.files.wordpress.com/2008/09/atasteofscratch_d3.png"><img src="http://chimu.files.wordpress.com/2008/09/atasteofscratch_d3.png" alt="" /></a></p>

<p>Not all application variables are shown, but those shown are the most important ones.  The details of the variables will be gone over later, but some are self-evident:</p>

<ul>
<li><p>num-disks: The number of disks (the height) of the Tower of Hanoi</p></li>
<li><p>pole-#: A List (treated as a Stack) of Disk identifiers, where &#8216;6&#8217; = a base (immovable) disk</p></li>
<li><p>movable-disks: A List of disks that can be moved.  This is transitory for each iteration of the algorithm.</p></li>
</ul>


<p>If you click the &#8216;Green Flag&#8217;, the program executes and on pretty much every step the display is updated, so you can see disks being proposed and moved (in both animation and variables).  Independently of Scratch having a graphical programming language, it has a very nice graphical development and run environment.</p>

<h3>Application Variables</h3>

<p>The application variables are shown below.  All of these are &#8216;Globals&#8217; and can be accessed by any object.  Those variables colored in red are lists and those colored in orange are numbers/strings/etc.  All the variables that have check-marks next to them are being displayed on top of the Stage above.</p>

<p><a href="http://chimu.files.wordpress.com/2008/09/atasteofscratch_d1.png"><img src="http://chimu.files.wordpress.com/2008/09/atasteofscratch_d1.png" alt="" /></a></p>

<p>There is no such thing as a &#8216;local&#8217; variable (private to a block of code), so it might be useful to use a naming prefix to differentiate between &#8216;local&#8217; variables (like &#8216;potential-disk&#8217;) from instance variables and even &#8216;parameter&#8217; variables that go with a broadcast (&#8216;next-disk&#8217;).  But in-the-small, that is not particularly important.</p>

<h3>Application Initialization</h3>

<p>Now that we have an overview of the application and its global state variables, we can start working through the algorithm itself.  The main &#8216;Object&#8217; in Scratch is the Stage, and I made this own the outer-most aspects of the Hanoi application and algorithm.  The first activity is &#8216;Initialization&#8217;, which is triggered by the &#8216;Green Flag&#8217; [my particular choice].</p>

<p><a href="http://chimu.files.wordpress.com/2008/09/atasteofscratch_d2.png"><img src="http://chimu.files.wordpress.com/2008/09/atasteofscratch_d2.png" alt="" /></a></p>

<p>Because this is the first example of Scratch, I will walk through the sections of the code and what they do with a few visual marker numbers (see the right column of blue).</p>

<p>When the Stage gets the Green Flag event:</p>

<ol>
<li><p>It sets the number of disks to &#8216;5&#8217;.  This is hard-coded because Scratch is currently unable to clone Sprites (objects) on the fly, so we have to precreate all the needed sprites.  In any case, this is simple enough to change if someone wants.  The additional variable &#8216;base-disk&#8217; is defined so it can be used below.  &#8216;base-disk&#8217; is just a local variable and is never used again. After this, we just clear the lists so they are &#8216;clean&#8217;</p></li>
<li><p>Next we add the &#8216;base-disk&#8217; to the bottom of each pole.  The base-disks are invisible and immovable (no matching Sprite/Object), so this is a very clean way of making the algorithm simpler later on.</p></li>
<li><p>Next we add the disks to &#8216;pole-1&#8217; using what should be another local variable.  Later I reuse this variable [something I don&#8217;t like doing] just because we otherwise have a clutter of variables.</p></li>
<li><p>Next we send out a broadcast to <em>all objects</em> telling them to initialize themselves.  There is no direct message send to an object, so it is up to the other objects to know what to respond to and what to ignore.  The broadcast waits until all object&#8217;s acknowledge they are finished.</p></li>
<li><p>Finally, we go into the main loop.  Until all the disks have moved to a new pole, we will execute &#8216;find-next-disk&#8217; which both finds and moves the next disk.  When we are done, we make a noise :-)</p></li>
</ol>


<h3>Find and Move Next Disk</h3>

<p>The main part of the algorithm has some nice aspects and some nastier aspects.  The nice side: We simply send out a broadcast of &#8216;propose-next-disk&#8217;, which all Disks should respond to by adding themselves to &#8216;movable-disks&#8217; if they have a desire to move.  This will only ever be one or two movable disks at any given time.  One of those disks may have been moved immediately previously, so we skip over it.  The selected disk is put into &#8216;next-disk&#8217; and another broadcast goes out &#8220;move-next-disk&#8221;.  The second broadcast is not really a broadcast.  It is a message send to &#8216;next-disk&#8217;, but it is only by the disks themselves ignoring a broadcast that isn&#8217;t to them that it becomes a message send.  So that is slightly nasty.</p>

<p>In any case, the code is pretty clean and concise, and this ends the code on the Stage itself.  The rest of the algorithm is on the Disks.</p>

<p><a href="http://chimu.files.wordpress.com/2008/09/atasteofscratch_d4.png"><img src="http://chimu.files.wordpress.com/2008/09/atasteofscratch_d4.png" alt="" /></a></p>

<h3>Disks Variables</h3>

<p>The Disks have access to all the Stage global variables.  In addition, each Sprite can have its own instance-private variables, which are either true instance variables (&#8216;disk-id&#8217;, &#8216;pole&#8217;, &#8216;previous-pole&#8217;) or would be local variables if Scratch supported them (&#8216;can-move&#8217;, &#8216;am-on-top&#8217;, etc.)</p>

<p><a href="http://chimu.files.wordpress.com/2008/09/atasteofscratch_d5.png"><img src="http://chimu.files.wordpress.com/2008/09/atasteofscratch_d5.png" alt="" /></a></p>

<p>Instance variables can be displayed on the Stage also, but this becomes overwhelming if all instances are turned on.</p>

<h3>Disk Initialization</h3>

<p>Upon receiving the &#8216;initialize&#8217; broadcast, all Disks set their &#8216;disk-id&#8217; (which must be different for each disk), and then set themselves up properly in size, color, and move onto the correct pole.</p>

<p><a href="http://chimu.files.wordpress.com/2008/09/atasteofscratch_d6.png"><img src="http://chimu.files.wordpress.com/2008/09/atasteofscratch_d6.png" alt="" /></a></p>

<h3>Propose Next Disk</h3>

<p>Scratch has certain deficiencies that rear their heads badly in the Hanoi code.  The concept of Propose Next Disk is as simple as:</p>

<pre><code>If 
   * I am on-top of a pole 
   * And I can move to a new pole (with a bigger disk on its top) 
   * And that new pole isn't the pole I just came from
Then
   * Add myself to the movable-disks list
</code></pre>

<p>But because Scratch (or my knowledge of Scratch) is deficient in dynamic referencing of variables, the &#8216;propose-next-disk&#8217; code needs to expand all the potential pole values from 1 through 3.  Fortunately this is only a three-valued expansion, but the code looks quite nasty for being as simple as the above.</p>

<p><a href="http://chimu.files.wordpress.com/2008/09/atasteofscratch_d7.png"><img src="http://chimu.files.wordpress.com/2008/09/atasteofscratch_d7.png" alt="" /></a></p>

<h3>Move Next Disk</h3>

<p>The Move Next Disk code has (1) the filter on the broadcast (in this case by &#8216;disk-id&#8217;) to make it only go to a single object and (2) a ton of noise due to &#8216;pole&#8217; expansion mentioned above.  But the code gets the job done and it looks fairly colorful :-)</p>

<p><a href="http://chimu.files.wordpress.com/2008/09/atasteofscratch_d8.png"><img src="http://chimu.files.wordpress.com/2008/09/atasteofscratch_d8.png" alt="" /></a></p>

<h2>Conclusions</h2>

<p>I was impressed that Scratch was able to get Tower of Hanoi to run properly.  Scratch has actively avoided certain features that the Scratch team finds are difficult to understand.  But the toolbox of event processing, broadcasts, lists, and Sprites (objects with Stage presence :-) ) are rich enough that a pre-sized Hanoi can be created and will run correctly.  A dynamic Hanoi would require Sprite cloning, which is not in Scratch 1.3.</p>

<p>The nastiest aspect to Scratch was its inability to dynamically reference the pole lists.  And a missing feature to Scratch are simple procedures (for example, the &#8216;glide&#8217; code is repeated twice).  The missing recursion is clearly another missing feature, but in this case getting rid of that recursion made the algorithm somewhat nicer.</p>

<p>On the whole, Scratch is a very inspiring visual language and development environment, and it did a good job with this &#8216;offbeat&#8217; test.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/09/04/ruby-naming-convention-failure/">Ruby Naming Convention Failure</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-09-04T01:20:00-07:00" pubdate data-updated="true">Sep 4<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Ruby has a strong recommendation against using CamelCase for method and variable names and to use only underscores instead.  There are lots of arguments out there on different naming conventions, and whatever side I pick in isolation is fairly irrelevant since either the whole community or the individual team has to chose the best approach.</p>

<p>In case people care, in isolation of other issues, I would pick this order as being the most natural:</p>

<ol>
<li><p>Mark-Fussell (or mark-fussell)</p></li>
<li><p>MarkFussell</p></li>
<li><p>Mark_Fussell (or mark_fussell)</p></li>
</ol>


<p>where the underscore goes third mostly because it can be hard to see [URLs and other things put underlines <em>on top</em> of that underline like thus <em>Mark_Fussell</em>], is harder to type, and it over spaces things visually.  So I (and lots of people actually) believe programming languages <em>should</em> use hyphens, but because a bunch of programming languages want &#8216;a-b&#8217; to be interpreted as &#8216;a - b&#8217;, they cop out and prevent the hyphen from being part of a name.  Ruby has that same cop out, so we can&#8217;t use hyphens in Ruby :-(</p>

<h2>Missing Phrase Delimiter</h2>

<p>So I said my opinion is fairly irrelevant, but I also want to say that people have missed an important aspect to this argument.  I may have a small preference for CamelCase over underlines as a single word delimiter, but I have a <em>huge</em> preference to having both a &#8216;word&#8217; and a &#8216;phrase&#8217; delimiter.  And by insisting on just one delimiter in this naming standard, Ruby has significantly interfered with expressiveness.  Maybe I am unusual, but I have long-time argued that we should have both words and phrases in methods and frequently even in classes.  Back in the 1990s, I documented this as part of my <a href="http://www.chimu.com/publications/javaStandards2/part0006.html#E11E13">JavaStandards</a> and this was based on Smalltalk naturally having both of these pieces.  It was clearly more readable and you were much less likely to produce bad method names.</p>

<p>For method naming, the quick summary is:</p>

<ul>
<li><p>When naming a method</p></li>
<li><p>Start with a verb phrase (what you are asking the object to do)</p></li>
<li><p>Put an underscore where a parameter is expected (up to the first two at least)</p></li>
<li><p>Describe what that parameter is for right before the underscore, if it is not obvious from the verb</p></li>
</ul>


<p>this way, the reader of the code can immediately know how the parameters (in the parentheses) map onto their role in the method itself.  And the whole method name becomes a readable phrase&#8230; not just a weird long word strung together (by whatever convention you want).</p>

<h3>Array::insert</h3>

<p>So an example is:</p>

<pre><code>Array::insert(index, obj)
</code></pre>

<p>This is a method name that is ambiguous in usage:</p>

<pre><code>anArray.insert(3,2)
</code></pre>

<p>It is not clear what the code is going to do and I would actually intuitively expect it to be the other way around (except I know about getting burned so would then have to look it up).</p>

<p>A better name would be:</p>

<pre><code>Array::insert_at(obj,index)
</code></pre>

<p>so reading:</p>

<pre><code>anArray.insert_at(3,2)
</code></pre>

<p>is clearly inserting the &#8216;3&#8217; not inserting the &#8216;2&#8217;.</p>

<p>Or if people like the order the other way:</p>

<pre><code>   Array::insertAt_value(index,obj)

   anArray.insertAt_value(2,3)
</code></pre>

<p>And in the Ruby case where any number of values could follow, we should have:</p>

<pre><code>   Array::insertAt_values(index,obj...)

   anArray.insertAt_values(2,3)
   anArray.insertAt_values(2,5,3)
</code></pre>

<p>and everything reads naturally something like this &#8220;anArray insertAt: 2 values: 5 and 3&#8221;.</p>

<h3>forPolesOtherThan_do(disk)</h3>

<p>Related to a recent post on the Tower of Hanoi, I believe the resulting choice of:</p>

<pre><code>forPolesOtherThan_do(disk) [block]
</code></pre>

<p>is much clearer in both communicating what the passed in &#8216;disk&#8217; is for and that it requires a block as a second (semi-hidden) argument than if you have only a word delimiter and have any of:</p>

<pre><code>   for_poles_other_than
   for_poles_other_than_do
   forPolesOtherThan
   forPolesOtherThanDo
</code></pre>

<h2>What to do?</h2>

<p>Given Ruby wants to use underscore to separate words&#8230; I can&#8217;t separate the phrases at all.  I tried to wrestle my mind around using something different, but Ruby surprisingly (for a modern and internationally-created) language does not have any other punctuation that is allowed and could plausibly work.  So maybe use two underscores for the phrase point?  That seems seriously ugly and also two underscores don&#8217;t really look different from one underscore:</p>

<pre><code>   insert_at__values
   for_poles_other_than__do
</code></pre>

<p>Using capitals for this purpose just comes off weird (plausible but weird):</p>

<pre><code>   insert_at_Values
   for_poles_other_than_Do
</code></pre>

<p>It is also exactly the opposite of Smalltalk, and I try to be able to work across languages without having to flip upside down all the time.  Same regarding Java and Flex (two other languages I actively work in).  For reference, the Smalltalk version of these examples are:</p>

<pre><code>   insertAt: values:
   forPolesOtherThan: do:
</code></pre>

<h3>Arguments about non-English speakers</h3>

<p>One argument I (so far) find specious is that using capitals prevents non-native speakers from understanding the code.  I could maybe believe this is true in rare cases &#8211; but (1) nobody has a study referenced that shows that, and (2) if that were true, someone simply has to learn the language better.  You can&#8217;t argue that some people&#8217;s inability to use a language is a reason to not use a feature of that language.  That would argue that almost all syntax in languages should be stripped, and few languages (and especially computer languages) can survive that.  Actually only Lisp survives that (give me just a pair of delimiters, and I can rule the world :-) )</p>

<p>Also given Ruby uses CamelCase for classes, you already have a requirement to understand this kind of syntax aspect.  So Ruby is presupposing the reader can read the syntax it is arguing the reader can&#8217;t read.</p>

<h3>The standard, in different languages</h3>

<p>A more interesting question is whether the &#8220;word and phrase standard&#8221; survives human-language change.  Obviously the standard does not work &#8220;as written&#8221; if the language used is not a capital-capable language.  And an obviously important language for that test is written Chinese (traditional or simplified).  But actually the &#8216;underscores for phrases and parameters&#8217; degrades with Chinese better than &#8216;underscores for words&#8217;.  Chinese doesn&#8217;t require spaces for words to be apparent, and does not use spaces at all for that purpose (normally) &#8211; it is obvious where each word starts and ends without spacing because a word is only a couple characters long.  So given words are apparent, the only thing left is to have phrases.  Although unnatural to use underscores for phrases and parameters, it at least seems plausibly useful.</p>

<p>Admittedly I have not tried in depth to program in Chinese (Smalltalk/Agents by QKS had the ability way back but I only played with it a little) and have not found a study on it&#8230;  so I can&#8217;t say for sure whether the underscore for parameters would make sense.  But it is at least plausible it would make sense and it would make much more sense than underscore to separate (already separated) words.</p>

<p>Another plausible language to test against would be Hindi, but (I believe) most writers of Hindi in the computer field are also excellent English writers, so that is harder to argue for.</p>

<h3>Could be hyphens</h3>

<p>Note that the convention is totally happy with using &#8216;hyphens&#8217; as word separators if the environment supports it.</p>

<pre><code>   insert-at_values
   for-poles-other-than_do
</code></pre>

<h2>Summary: Ruby has it wrong &#8211; We need CamelWords or hyphen-words</h2>

<p>So I believe Ruby has it wrong and am very unhappy a modern language started 20 years after Smalltalk and several years after Dylan would get this kind of thing wrong.  And I recommend moving the Ruby standard to the CamelWord_UnderPhrase standard, or allowing the hyphen and use the hyphen-word_under-phrase standard.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/09/03/a-taste-of-ruby-part-7/">A Taste of Ruby (Part 7)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-09-03T02:28:00-07:00" pubdate data-updated="true">Sep 3<span>rd</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content">
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/09/03/a-taste-of-ruby-part-6/">A Taste of Ruby (Part 6)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-09-03T02:18:00-07:00" pubdate data-updated="true">Sep 3<span>rd</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is a multi-part series.  The first in the series is <a href="../../../08/28/a-taste-of-ruby">here</a>.</p>

<h2>Tower of Hanoi — With Rule Disks (and no stack)</h2>

<p>The first passes at the Tower of Hanoi algorithm were all done with the algorithm being a recursive call on the stack.  This is &#8216;true&#8217; as an algorithm, but comes off as a bit unnatural for humans.</p>

<p>But it also has a problem in that the algorithm can not be &#8216;suspended&#8217; in mid activity unless the language allows a feature (called a continuation) that can suspend the stack itself.  Although Ruby is multi-threaded and running two threads works in RubyShoes, Rails does not work either with a stateful server (and multiple threads) or with continuations.  At the end of each controller dispatch the session or the database has to have persisted all state.  So we need to do something like formalizing the state of the Disks and Towers to make the Tower of Hanoi work with Rails.</p>

<p>Also, the Smalltalk code in this section was among the most &#8216;closure-oriented&#8217;, so this helps show how that maps to Ruby.</p>

<h3>You aren&#8217;t capitalizing right?</h3>

<p>Before continuing into the code, people should realize I actively object to Ruby&#8217;s choice to have only one &#8216;word&#8217; delimiter by convention.  See my article <a href="ruby-naming-convention-failure">Ruby Naming Convention Failure</a> for details and the naming conventions I use, especially for methods.  But the quick summary is:</p>

<ul>
<li><p>I use CamelCase for combining words into a &#8216;part&#8217; of a method name or variable name</p></li>
<li><p>I use an underscore as a placeholder for the parameters of the method</p></li>
<li><p>I use an underscore to break up a phrase into logical parts</p></li>
</ul>


<p>If Ruby supported some other word delimiter than underscore (say hyphen &#8220;-&#8221; or &#8220;:&#8221;), I would be agnostic to dropping the CamelCase, but without that second word delimiter, dropping CamelCase is a losing proposition in expressiveness.  In a team setting we might have to discuss this, but in this case this is my code alone&#8230; and my standard actually makes it easier to convert to-from Smalltalk, Ruby, Flex, Java, etc.  The standard works cleanly with all of them.</p>

<h3>Tower&#8230;</h3>

<p>To migrate to the Rules version of the HanoiTower, it is easiest to start with the Disks themselves.</p>

<h4>RulesHanoiDisk</h4>

<p>A Rules based HanoiDisk just needs to be able to say &#8220;Can I move somewhere&#8221; and &#8220;If so, where&#8221;.  It does this in collaboration with the Tower.  &#8220;@tower&#8221; is now an instance variable that every Disk has set when it is created.  By using an instance variable, it is cleaner than using class variables (we can have multiple towers at the same time) and it works under Ruby serialization/marshalling.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">RulesHanoiDisk</span> <span class="o">&lt;</span> <span class="no">AnimatedHanoiDisk</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">hasLegalMove</span><span class="p">()</span>
</span><span class='line'>    <span class="vi">@towers</span><span class="o">.</span><span class="n">forPolesOtherThan_do</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span> <span class="n">eachTopDisk</span> <span class="o">|</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">eachTopDisk</span><span class="o">.</span><span class="n">width</span>  <span class="o">&gt;</span> <span class="nb">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="k">then</span> <span class="k">return</span> <span class="kp">true</span> <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="k">return</span> <span class="kp">false</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">bestMove</span><span class="p">()</span>
</span><span class='line'>    <span class="vi">@towers</span><span class="o">.</span><span class="n">forPolesOtherThan_do</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span> <span class="n">eachTopDisk</span> <span class="o">|</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">eachTopDisk</span><span class="o">.</span><span class="n">width</span> <span class="o">&gt;</span> <span class="nb">self</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">eachTopDisk</span><span class="o">.</span><span class="n">pole</span> <span class="o">!=</span> <span class="vi">@previousPole</span><span class="p">)</span> <span class="p">)</span> <span class="k">then</span> <span class="k">return</span> <span class="n">eachTopDisk</span> <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="k">return</span> <span class="kp">nil</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">move_upon</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@previousPole</span> <span class="o">=</span> <span class="vi">@pole</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">super</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Among the interesting things with the new RulesHanoiDisk is the extensive use of Blocks.  By using Blocks, we can iterate over the collection of stacks without creating new collections.  The Disk and the Tower collaborate to create custom iterators with minimal code.  See RulesTowerOfHanoi for the example.</p>

<h4>RulesTowerOfHanoi</h4>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">RulesTowerOfHanoi</span> <span class="o">&lt;</span> <span class="no">AnimatedTowerOfHanoi</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initHeight</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@height</span> <span class="o">=</span> <span class="n">height</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nb">self</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">move_tower</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">fromPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">,</span> <span class="n">usingPin</span><span class="p">)</span>
</span><span class='line'>    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">doNextMove_IsDone</span><span class="p">())</span> <span class="k">do</span> <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">createDisk</span><span class="p">()</span>
</span><span class='line'>    <span class="n">result</span> <span class="o">=</span> <span class="no">RulesHanoiDisk</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>    <span class="n">result</span><span class="o">.</span><span class="n">setupTowers</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">result</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">doNextMove_IsDone</span><span class="p">()</span>
</span><span class='line'>    <span class="vi">@currentDisk</span> <span class="o">=</span> <span class="n">decide</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@stacks</span><span class="o">[</span><span class="vi">@currentDisk</span><span class="o">.</span><span class="n">pole</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">pop</span><span class="p">()</span>
</span><span class='line'>    <span class="vi">@stacks</span><span class="o">[</span><span class="vi">@destinationDisk</span><span class="o">.</span><span class="n">pole</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">push</span><span class="p">(</span><span class="vi">@currentDisk</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@currentDisk</span><span class="o">.</span><span class="n">move_upon</span><span class="p">(</span><span class="vi">@destinationDisk</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@oldDisk</span> <span class="o">=</span> <span class="vi">@currentDisk</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@app</span><span class="o">.</span><span class="n">noteChange</span> <span class="k">if</span> <span class="vi">@app</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="n">isAllOnOneTower</span><span class="p">()</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">isAllOnOneTower</span><span class="p">()</span>
</span><span class='line'>    <span class="n">foundStack</span> <span class="o">=</span> <span class="vi">@stacks</span><span class="o">.</span><span class="n">detect</span> <span class="p">{</span> <span class="o">|</span><span class="n">eachStack</span><span class="o">|</span>  <span class="n">eachStack</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="vi">@height</span> <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">foundStack</span> <span class="o">!=</span> <span class="kp">nil</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">forTopsOtherThan_do</span><span class="p">(</span><span class="n">disk</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@stacks</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span> <span class="n">eachStack</span> <span class="o">|</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">eachStack</span><span class="o">.</span><span class="n">empty?</span><span class="p">)</span> <span class="k">then</span> <span class="k">next</span> <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">topDisk</span> <span class="o">=</span> <span class="n">eachStack</span><span class="o">.</span><span class="n">last</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">topDisk</span> <span class="o">==</span> <span class="n">disk</span><span class="p">)</span> <span class="k">then</span> <span class="k">next</span> <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">yield</span> <span class="n">topDisk</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">forPolesOtherThan_do</span><span class="p">(</span><span class="n">disk</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@stacks</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span> <span class="n">eachStack</span><span class="p">,</span> <span class="n">i</span> <span class="o">|</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">disk</span><span class="o">.</span><span class="n">pole</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span> <span class="k">next</span> <span class="k">end</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">topDisk</span> <span class="o">=</span> <span class="k">if</span> <span class="p">(</span><span class="n">eachStack</span><span class="o">.</span><span class="n">empty?</span><span class="p">)</span> <span class="k">then</span> <span class="vi">@mockDisks</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="k">else</span> <span class="n">eachStack</span><span class="o">.</span><span class="n">last</span> <span class="k">end</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">yield</span> <span class="n">topDisk</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">decide</span>
</span><span class='line'>    <span class="n">forTopsOtherThan_do</span><span class="p">(</span><span class="vi">@oldDisk</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span> <span class="n">eachDisk</span> <span class="o">|</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">eachDisk</span><span class="o">.</span><span class="n">hasLegalMove</span><span class="p">)</span> <span class="k">then</span>
</span><span class='line'>        <span class="vi">@destinationDisk</span> <span class="o">=</span> <span class="n">eachDisk</span><span class="o">.</span><span class="n">bestMove</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="n">eachDisk</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/09/02/a-taste-of-flex-part-6/">A Taste of Flex (Part 6)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-09-02T09:46:40-07:00" pubdate data-updated="true">Sep 2<span>nd</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content">
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/09/02/a-taste-of-flex-part-2/">A Taste of Flex (Part 2)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-09-02T04:12:00-07:00" pubdate data-updated="true">Sep 2<span>nd</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is a multi-part series.  The first in the series is <a href="a-taste-of-flex">here</a>.</p>

<h2>Tower of Hanoi &#8211; Procedural With Input</h2>

<p>The second example from &#8220;A Taste of Smalltalk&#8221; is in Chapter 3, page 36 and does basic IO.  Except that Smalltalk-80 includes a Windowing graphics system so it can automatically open Dialogs and other things.    Fortunately Flex includes a Windowing system too, and can easily open up dialogs.  Opening up a Dialog might match the Smalltalk example the best, but given Flex is already running within a Window, opening up an extra dialog is a bit artificial.  Instead we can just add an input field for the value and a button to kick off the Hanoi.</p>

<h3>Tower of Hanoi &#8211; Procedural With Input &#8211; Flex</h3>

<p>[sourcecode language=&#8221;xml&#8221;]</p>

<p>[/sourcecode]</p>

<p>To replace the dialog (in Smalltalk) or the command line request (in Ruby), we just create a horizontal row of a question label, an input field, and a Do It button.  Whenever a user clicks Do It, it takes the current value of the field and runs the Hanoi algorithm.</p>

<p>This is both pleasingly simply and also has the added benefit that we produced an interactive tool: you can just keep typing new numbers into it and it will give you new results.</p>

<h2>Comments</h2>

<p>Flex is highly capable with user input and interactivity.  It has a cleaner / simpler UI model than Smalltalk (IMO), which is good given we have had about 30 years of working with UIs to take things forward.  Compared to Ruby, Flex is as easy as RubyShoes for simple things like this example.</p>

<h3>Where Next?</h3>

<p>Next we should go to Chapter 4 — Page 44. The Third Example (with Real Hanoi Classes)</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p>
      <a href="http://www.linkedin.com/in/markfussell/">Linked In</a>
      &bull;
      <a href="http://github.com/markfussell/">Github</a>
      &bull;
      <a href="http://palobots.org/">PaloBots</a>
  </p>
    <!--
  <ul>
      <li><a href="http://www.linkedin.com/in/markfussell/">Linked In</a></li>
      <li><a href="http://github.com/markfussell/">Github</a></li>
      <li><a href="http://palobots.org/">PaloBots</a></li>
  </ul>
  &#8211;>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/01/13/git-about-everything-annex/">Being a git about everything (Annexing)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/11/git-about-everything-intro/">Being a git about everything (Intro)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2008/09/19/scratchonflash/">Scratch on Flash</a>
      </li>
    
      <li class="post">
        <a href="/blog/2008/09/17/scratch-textual-language/">Scratch Textual Language</a>
      </li>
    
      <li class="post">
        <a href="/blog/2008/09/08/a-taste-of-scratch/">A Taste of Scratch</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/markfussell">@markfussell</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'markfussell',
            count: 6,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>






  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Mark Fussell -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'markfussell';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
