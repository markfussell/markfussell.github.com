
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Polyglot</title>
  <meta name="author" content="Mark Fussell">

  
  <meta name="description" content="This is a multi-part series. The first in the series is here. Tower of Hanoi — With Graphics To follow the flow of code progress within &#8220;A &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://markfussell.github.com/blog/page/2/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Polyglot" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Polyglot</a></h1>
  
    <h2>Wants a cracker</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:markfussell.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/09/02/a-taste-of-flex-part-5/">A Taste of Flex (Part 5)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-09-02T00:44:58-07:00" pubdate data-updated="true">Sep 2<span>nd</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is a multi-part series. The first in the series is <a href="a-taste-of-flex">here</a>.</p>

<h2>Tower of Hanoi — With Graphics</h2>

<p>To follow the flow of code progress within &#8220;A Taste of Smalltalk&#8221;, we next need to include a graphical representation of the disks and their movement between the poles.  Flex lives inside a Flash player (or app), so it is inherently capable of doing sophisticated graphics.  Actually it is hard to &#8216;contain&#8217; yourself to just doing the simplest possible thing when animating sprites around the screen is very easy.  But to try to compare Flex to Ruby and Smalltalk, we want to keep things in about the same ballpark &#8211; and again study how different languages work with the same problem.</p>

<h3>Tower of Hanoi — With Graphics &#8211; Flex</h3>

<p>Given our Flex version is already in a graphics environment, and the model (TowerOfHanoi) is already aware of having to talk the View, the changes are relatively minimal to get things working.  We need to render the disks in the Application/View and we need to notify the view whenever the model changes.</p>

<h4>Main Application</h4>

<p>To add rendering in, we just create a render canvas area and then create the UIComponents (shapes) on each redraw.  Normally we would be more likely to animate a single set of disks (vs. destroying them and recreating them), which would be both better in performance and be <em>much cooler</em>, but this matches the RubyShoes version better.</p>

<p>[sourcecode language=&#8221;xml&#8221;]</p>

<p>[/sourcecode]</p>

<h4>AnimatedTowerOfHanoi</h4>

<p>The AnimatedTower just needs to send out change events (via a simple callback vs. true event listeners that are in Flex).</p>

<p>[sourcecode language=&#8221;jscript&#8221;]
package {</p>

<p>public class AnimatedTowerOfHanoi extends ModeledTowerOfHanoi {</p>

<pre><code>protected override function setupDisks() : void {
    super.setupDisks();

    my_view.noteChange();
}

public function getStacks() : Array {
    return my_stacks;
}

protected override function moveDisk(fromPin : *, toPin : *) : void {
    super.moveDisk(fromPin, toPin);

    my_view.noteChange();
}
</code></pre>

<p>}</p>

<p>} //package
[/sourcecode]</p>

<h3>Super Easy&#8230;But doesn&#8217;t work</h3>

<p>Well, that was really easy&#8230; except it doesn&#8217;t really work :-(  You can only see the final result of all the nice disks on the last stack.  None of the intermediary steps before this last rendering are shown at all.</p>

<p>Clearly we are missing something&#8230; where is the &#8220;Sleep&#8221; equivalent?  If we could add a &#8216;sleep&#8217; then everything would work right?  Unfortunately both &#8220;No&#8221; and &#8220;NO!&#8221;.  When Flex/Flash are running user code, they are doing it between screen renderings and a bunch of other tasks Flash does.  So you can&#8217;t just keep rendering things in the same thread (same stack) and have any of that be visible except the last version.  If you could &#8216;sleep&#8217;, you would just make Flash pause for no good reason.</p>

<p>The solution is to do each rendering on some kind of event.  Something simple like do the next step of the hanoi algorithm every 0.3 seconds.  That sounds easy but: (1) Flex doesn&#8217;t have continuations either so you can&#8217;t just &#8216;pause&#8217; the stack and (2) The current hanoi algorithm is completely stack based.</p>

<p>Fortunately the fix is both &#8220;not that hard&#8221; and also happens to be the next chapter of &#8220;A Taste of Smalltalk&#8221; called &#8220;An Algorithm for the Rest of Us&#8221;.  So for the moment, lets punt on getting the animation in Flex right until we get to the next part.</p>

<h3>What&#8217;s Next</h3>

<p>A new non-stack algorithm.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/09/02/a-taste-of-flex-part-4/">A Taste of Flex (Part 4)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-09-02T00:13:17-07:00" pubdate data-updated="true">Sep 2<span>nd</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content">
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/09/01/a-taste-of-flex-part-3/">A Taste of Flex (Part 3)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-09-01T22:11:06-07:00" pubdate data-updated="true">Sep 1<span>st</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content">
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/09/01/a-taste-of-flex/">A Taste of Flex</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-09-01T17:29:35-07:00" pubdate data-updated="true">Sep 1<span>st</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>One of my favored books in the 1980s was ‘A Taste of Smalltalk’. This was a very short book that gave you the flavor of Smalltalk programming (the language and IDE) as compared to Pascal, C, and Lisp. I believe it is always important to show multiple programming languages for concepts and this book followed that rule. The goal of this post-series is to take ‘A Taste of Smalltalk’ and apply it to Flex.  This is the second of my comparisons in this series, where the first one was in Ruby.</p>

<p>You can find the original book here:</p>

<ul>
<li><p><a href="http://www.iam.unibe.ch/~ducasse/FreeBooks/Taste/">A Taste of Smalltalk</a></p></li>
<li><p><a href="http://stephane.ducasse.free.fr/FreeBooks.html">Free Smalltalk Books</a></p></li>
</ul>


<p>Given the original book is available online, I will not repeat it.</p>

<p>To run these Flex examples, you should have a Flex SDK, which you can find at <a href="http://opensource.adobe.com/wiki/display/flexsdk/Flex+SDK">FlexSDK</a> or via <a href="http://www.adobe.com/">http://www.adobe.com/</a>.  The SDK is free.</p>

<p>For playing with Smalltalk, you can pick up Squeak from <a href="http://squeak.org/">http://squeak.org/</a>.  Squeak&#8217;s UI is a bit different from Smalltalk-80 (in the book), but if you go through a quick Squeak tutorial, you should be able to connect the two.</p>

<h2>Tower of Hanoi &#8211; Procedural &#8211; Flex</h2>

<p>The first example in &#8216;A Taste&#8217; is in multiple languages (Chapter 1).  This is Tower of Hanoi done totally procedurally.  Converting to Flex is very simple, where the &#8216;creationComplete&#8217; event is about the equivalent of a &#8216;main&#8217; / script entrypoint.</p>

<p>[sourcecode language=&#8217;xml&#8217;]</p>

<p>[/sourcecode]</p>

<p>Note that Flex will be treated a bit unfairly in the formatting department (as is Smalltalk) because the &#8216;sourcode plugin&#8217; in WordPress isn&#8217;t working for them.  If someone recommends a &#8216;snippet&#8217; location that understand Flex or AS3 (and Smalltalk and everything else :-) ), I can put this up there to format it more nicely.</p>

<p>So what is interesting about Flex in this example?</p>

<ul>
<li><p>Multiple Syntaxes</p></li>
<li><p>Pascal Declaration Ordering</p></li>
<li><p>As Statically Typed As You Want</p></li>
<li><p>No Main</p></li>
<li><p>The Cheat</p></li>
</ul>


<h3>Multiple Syntaxes, each for a different purpose</h3>

<p>Well, obviously first Flex is not a single syntax but a composite of at least two syntaxes used for different purposes:</p>

<ul>
<li><p>XML is used to create objects, including the outer &#8216;Application&#8217; object</p></li>
<li><p>AS3 (ActionScript3) is used to define classes</p></li>
</ul>


<p>So any Flex application will have both of these syntaxes, and they can either be in the same file (as above), or a better practice is to separate the two as much as possible where the XML becomes the View/Layout and the AS files manage behavior.  But for the moment, I will keep them together.</p>

<p>The third syntax is CSS, which can again be either embedded or kept in a separate file.  Although learning three syntaxes is an increase in initial work, two of the three syntaxes are almost universal (XML, CSS) and necessary for doing most anything.  And because each is used for a different purpose, they blend together quite naturally.</p>

<h3>Pascal Notation</h3>

<p>ActionScript chose to go down the far more natural &#8216;type suffix&#8217; notation of Pascal and related languages.  This isn&#8217;t really interesting except that C (for compiler ease) went down a different path and a lot of mainstream languages (e.g. Java) followed in that path.  Especially given that ActionScript does not require type declarations, it seems to have chosen wisely, but people are touchy about this kind of syntax choice.</p>

<h3>As Statically Typed As You Want</h3>

<p>In the code, you can see types declared as &#8216;: <em>&#8217; &#8211; meaning &#8216;Any Type&#8217;.  You could also leave off the type declaration and it would mean the same thing, but including the &#8216;: </em>&#8217; makes it clear I intend to allow any type of object to be used.  So ActionScript can be as statically typed as you want: either completely dynamic like Smalltalk or Ruby or others, or basically as statically as Java (with a similar static type model).</p>

<h3>No Main</h3>

<p>Flex is not a scripting language&#8230; it is a graphical application language and application environment that can run either standalone (in Air) or within a browser.  So there is not really a &#8216;main&#8217; script that executes.  The equivalent to &#8216;main&#8217; is that when an Application is constructed, at the very end of that construction, an event of &#8216;creationComplete&#8217; will be sent out.  So this is about as close to a &#8216;main&#8217; as we can get.  You could pick up command-line arguments or browser parameters within this &#8216;handleCreationComplete&#8217; handler.</p>

<h3>The Cheat</h3>

<p>OK, now for the cheat that is in the above code.  If anyone executed the above code within Flex in Debug mode, it would work pretty much as you expect and put lines out to a debugging console.  But it would have to be run in Debug mode for that.  If you run it normally, the &#8216;trace&#8217; output wouldn&#8217;t show anywhere.</p>

<p>I only cheated to make it easier to see the main core of the application code separate from the GUI aspects of the language (just as I tried to do with Ruby).  Flex has graphics capabilities (just like Smalltalk) but is not part of an IDE (as opposed to Smalltalk) and is not a scripting language (like Perl or Ruby) and did not include &#8216;System output&#8217; (like Java) because it would be useless in a Browser and for 99.9% of any Flex / Flash deployment.  But it does include tracing for development and debugging purposes&#8230; so I cheated and used that.</p>

<p>The important thing about a cheat is to recognize it and fix it&#8230; so let&#8217;s next enhance the Flex application to show output.</p>

<h2>Showing Console-like output in Flex</h2>

<p>Adding a console output only requires two lines of code</p>

<pre><code>        function moveDisk(fromPin : *, toPin : *) : void {
            vConsole.text = vConsole.text+fromPin + "-&gt;" + toPin+"\n";
        }
</code></pre>

<p>and</p>

<p>[sourcecode language=&#8217;xml&#8217;]</p>

<p>[/sourcecode]</p>

<p>so it would have been just as easy to do it this way initially, but then a &#8220;language&#8221; difference in its application environment would have been a bit more hidden.</p>

<h2>Augmenting Existing Classes (Monkey-Patching)</h2>

<p>As described in &#8216;A Taste of Ruby&#8217;, the Smalltalk example from the book actually modifies &#8216;Object&#8217;, so &#8216;moveTower&#8217; is available on any object.  This is certainly possible in Flex but would require actively talking to Object.prototype to add behavior.  If you do this, the system will run but the compiler will have no idea that it will run correctly (and really it will have no &#8216;understanding&#8217; of the code you added).  Modifying Object was contrived but easy in Smalltalk, contrived but easy in Ruby, and contrived but &#8216;not-so-hard&#8217; in Flex.  So for Flex it is the strangest to do.  But here is the very contrived Flex code anyway :-)</p>

<pre><code>Foo
</code></pre>

<h3>Monkey-Patching vs. Source Patching/Augmenting</h3>

<p>For Smalltalk and Flex you have the vendor-supplied source, which you could easily patch as part of the source version/modification control system.  So the question becomes:</p>

<blockquote><p>Why wouldn&#8217;t patching occur at the source-code level so people can see what changes have happened?</p></blockquote>

<p>Smalltalk wrestled with this for years with different vendors and different teams choosing different approaches.  I personally believe that the current Monticello for Squeak and the heavyweight &#8216;Envy&#8217; (and similar source code tools) get this right in that you could certainly modify an existing class but those changes had to be documented as source changes and had to <em>not conflict</em> (with Monticello having a nicer model than Envy [if memory serves for Envy]).</p>

<p>So although I don&#8217;t think Flex needs these kinds of changes particularly for what Flex is used for, something that enables you to bring system classes into your own modifiable version-control space and then allow patching on that space is nicer than having everyone hit the main space without clear visibility to what they are doing (effectively Ruby&#8217;s current mainstream choice).</p>

<h2>Comments</h2>

<p>This example from &#8220;A Taste of Smalltalk&#8221; is the highly procedural version.  It is not meant to be a particularly good program, but it is a simple and good introductory example.  Flex does fine with this example: it does not artificially type the &#8216;moveTower&#8217; parameters.  It has a bit more static typing, which helps avoid typos.  But everything is an object, so dynamic typing works fine too.</p>

<p>Because Flex includes an inherent GUI environment (but no inherent Console) we had to add one line of MX code to create that console.  Flex is a three-syntax set of families so it can look a bit complex to begin with (wrapper XML and the CDATA ActionScript) but the use of the XML is clean and for a specific purpose that ActionScript and most languages (say other than Lisp) are not as good for.  And using XML for page layout is very familiar to people (e.g. XHTML) and goes nicely with the CSS capabilities in Flex as well.</p>

<h3>Where Next?</h3>

<p>Next we should go to Chapter 3 &#8211; Page 36.  The Second Example.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/08/29/a-taste-of-ruby-part-5/">A Taste of Ruby (Part 5)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-29T23:42:00-07:00" pubdate data-updated="true">Aug 29<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is a multi-part series. The first in the series is <a href="../2008-08-28/a-taste-of-ruby">here</a>.</p>

<h2>Tower of Hanoi — With Graphics</h2>

<p>To follow the flow of code progress within &#8220;A Taste of Smalltalk&#8221;, we next need to include a graphical representation of the disks and their movement between the poles.  As mentioned previously, converting this part to Ruby has a problem: Ruby doesn&#8217;t include graphic capabilities.  So we have to pick an extension or add-on to Ruby that will enable us to hook into the graphics system.</p>

<p>Because it seems the easiest to work with, I chose &#8216;Shoes&#8217; (<a href="http://code.whytheluckystiff.net/shoes/">http://code.whytheluckystiff.net/shoes/</a>).  The installation of Shoes is very simple and you just run your &#8216;app&#8217; inside Shoes application world, which includes Ruby itself, the graphic capabilities, and the UI framework.</p>

<p>Shoes seems simple and clean, the only problem is it doesn&#8217;t work within an IDE, so I lost a bit of tooling while doing this.  With the final running program, this isn&#8217;t a problem but it can be painful if you are learning, tweaking, or studying things.  So because this could be painful to others as well, I made the main code base able to run inside a normal irb, and in that case it just logs to the console like it always has been.</p>

<p>The main new class is AnimatedTowerOfHanoi, which is really just a notifying version of ModeledTowerOfHanoi.  This pass also has some cleanup of the previous code of ModeledTowerOfHanoi.  So I include all three classes below</p>

<h3>The New Classes</h3>

<h4>TowerOfHanoi</h4>

<p>This is still the same as the original from &#8216;Part 2&#8217;</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># A Taste of Ruby.  Based on a Taste of Smalltalk (Kaehler and Patterson)</span>
</span><span class='line'><span class="c1"># Tower of Hanoi -- Variation 5</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># TowerOfHanoi</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># @stacks is an Array of DiskHolders (pins)</span>
</span><span class='line'><span class="k">class</span> <span class="nc">TowerOfHanoi</span> <span class="o">&lt;</span> <span class="no">Object</span>
</span><span class='line'>  <span class="c1">#Tower of Hanoi program.</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">hanoi</span>
</span><span class='line'>    <span class="c1"># Do the tower</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;How tall a tower?&quot;</span>
</span><span class='line'>    <span class="nb">print</span> <span class="s2">&quot;&gt;&quot;</span>
</span><span class='line'>    <span class="n">height</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1">#gets.to_i</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@stacks</span> <span class="o">=</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span> <span class="p">}</span>
</span><span class='line'>    <span class="n">firstStack</span> <span class="o">=</span> <span class="vi">@stacks</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
</span><span class='line'>    <span class="mi">1</span><span class="o">.</span><span class="n">upto</span><span class="p">(</span><span class="n">height</span><span class="p">)</span> <span class="p">{</span><span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="n">firstStack</span><span class="o">.</span><span class="n">unshift</span><span class="p">(</span><span class="s2">&quot;Disk-</span><span class="si">#{</span><span class="p">(</span><span class="sc">?A</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">chr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">move_tower</span><span class="p">(</span><span class="n">height</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Recursive procedure to move the disk at a height</span>
</span><span class='line'>  <span class="c1"># from one pin to another pin using a third pin</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">move_tower</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">fromPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">,</span> <span class="n">usingPin</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">height</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
</span><span class='line'>      <span class="n">move_tower</span><span class="p">(</span><span class="n">height</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">fromPin</span><span class="p">,</span> <span class="n">usingPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">)</span>
</span><span class='line'>      <span class="n">move_disk</span><span class="p">(</span><span class="n">fromPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">)</span>
</span><span class='line'>      <span class="n">move_tower</span><span class="p">(</span><span class="n">height</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">usingPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">,</span> <span class="n">fromPin</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Actually move the disk between the pins</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">move_disk</span><span class="p">(</span><span class="n">fromPin</span><span class="p">,</span><span class="n">toPin</span><span class="p">)</span>
</span><span class='line'>    <span class="n">disk</span> <span class="o">=</span> <span class="p">(</span><span class="vi">@stacks</span><span class="o">[</span><span class="n">fromPin</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">pop</span>
</span><span class='line'>    <span class="vi">@stacks</span><span class="o">[</span><span class="n">toPin</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">push</span><span class="p">(</span><span class="n">disk</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">print</span> <span class="n">disk</span><span class="p">,</span> <span class="s2">&quot; moved &quot;</span><span class="p">,</span> <span class="n">fromPin</span><span class="o">.</span><span class="n">to_s</span><span class="p">,</span> <span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">toPin</span><span class="o">.</span><span class="n">to_s</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h4>ModeledTowerOfHanoi</h4>

<p>The ModeledTowerOfHanoi has been cleaned up a little to make subclassing easier and just because it was the right thing to do.  Specifically,</p>

<ul>
<li><p>There was a fix to the &#8216;move&#8217; algorithm, so we tell the disk onto which disk it is moving</p></li>
<li><p>Some common methods are pulled out</p></li>
<li><p>Disks are now responsible for describing the move</p></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># A ModeledTowerOfHanoi is the TowerOfHanoi algorithm</span>
</span><span class='line'><span class="c1"># but it actually keeps track of the state of the Disks</span>
</span><span class='line'><span class="c1"># with actual objects.  This makes it suitable for</span>
</span><span class='line'><span class="c1"># model-based behavior (say tracking moves, animation or</span>
</span><span class='line'><span class="c1"># other event listening) on top of those Disks</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">ModeledTowerOfHanoi</span> <span class="o">&lt;</span> <span class="no">TowerOfHanoi</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">hanoi</span>
</span><span class='line'>    <span class="n">ask_for_height</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">setup_disks</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;Start&quot;</span>
</span><span class='line'>    <span class="n">print_stacks</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">puts</span>
</span><span class='line'>    <span class="n">move_tower</span><span class="p">(</span><span class="vi">@height</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">puts</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;Result&quot;</span>
</span><span class='line'>    <span class="n">print_stacks</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">print_stacks</span>
</span><span class='line'>    <span class="vi">@stacks</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span> <span class="n">eachStack</span> <span class="o">|</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s2">&quot;  &quot;</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="n">eachStack</span><span class="o">.</span><span class="n">reverse</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s2">&quot;  &quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">ask_for_height</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;How tall a tower?&quot;</span>
</span><span class='line'>    <span class="nb">print</span> <span class="s2">&quot;&gt;&quot;</span>
</span><span class='line'>    <span class="n">height</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1">#gets.to_i</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>    <span class="vi">@height</span> <span class="o">=</span> <span class="n">height</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">setup_disks</span>
</span><span class='line'>    <span class="no">HanoiDisk</span><span class="o">.</span><span class="n">set_towers</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@stacks</span> <span class="o">=</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span> <span class="p">}</span>
</span><span class='line'>    <span class="n">firstStack</span> <span class="o">=</span> <span class="vi">@stacks</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
</span><span class='line'>    <span class="mi">1</span><span class="o">.</span><span class="n">upto</span><span class="p">(</span><span class="vi">@height</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">size</span><span class="o">|</span>
</span><span class='line'>      <span class="n">disk</span> <span class="o">=</span> <span class="n">createDisk</span><span class="o">.</span><span class="n">initWidth_pole</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="n">firstStack</span><span class="o">.</span><span class="n">unshift</span><span class="p">(</span><span class="n">disk</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@mockDisks</span> <span class="o">=</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span class='line'>    <span class="mi">1</span><span class="o">.</span><span class="n">upto</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
</span><span class='line'>      <span class="vi">@mockDisks</span><span class="o">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">]=</span><span class="p">(</span><span class="n">createDisk</span><span class="o">.</span><span class="n">initWidth_pole</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="n">i</span><span class="p">))</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">createDisk</span><span class="p">()</span>
</span><span class='line'>    <span class="k">return</span> <span class="no">HanoiDisk</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">move_disk</span><span class="p">(</span><span class="n">fromPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">supportDisk</span> <span class="o">=</span> <span class="k">if</span> <span class="p">(</span><span class="vi">@stacks</span><span class="o">[</span><span class="n">toPin</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">empty?</span><span class="p">)</span> <span class="k">then</span>
</span><span class='line'>      <span class="vi">@mockDisks</span><span class="o">[</span><span class="n">toPin</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="vi">@stacks</span><span class="o">[</span><span class="n">toPin</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">last</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">disk</span> <span class="o">=</span> <span class="vi">@stacks</span><span class="o">[</span><span class="n">fromPin</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">pop</span>
</span><span class='line'>    <span class="vi">@stacks</span><span class="o">[</span><span class="n">toPin</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">push</span><span class="p">(</span><span class="n">disk</span><span class="p">)</span>
</span><span class='line'>    <span class="n">disk</span><span class="o">.</span><span class="n">move_upon</span><span class="p">(</span><span class="n">supportDisk</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="n">outString</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">print</span> <span class="n">outString</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">HanoiDisk</span>
</span><span class='line'>  <span class="kp">attr_reader</span> <span class="ss">:name</span>
</span><span class='line'>  <span class="kp">attr_reader</span> <span class="ss">:pole</span>
</span><span class='line'>  <span class="kp">attr_reader</span> <span class="ss">:width</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">set_towers</span><span class="p">(</span><span class="n">owner</span><span class="p">)</span>
</span><span class='line'>    <span class="vc">@@the_towers</span> <span class="o">=</span> <span class="n">owner</span>
</span><span class='line'>    <span class="vc">@@the_thickness</span> <span class="o">=</span> <span class="mi">14</span>
</span><span class='line'>    <span class="vc">@@the_diskgap</span> <span class="o">=</span> <span class="mi">2</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initWidth_pole</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">pole</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@pole</span> <span class="o">=</span> <span class="n">pole</span>
</span><span class='line'>    <span class="vi">@width</span> <span class="o">=</span> <span class="n">width</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">width</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">)</span> <span class="k">then</span>
</span><span class='line'>      <span class="vi">@name</span><span class="o">=</span><span class="s2">&quot;Disk-</span><span class="si">#{</span><span class="p">(</span><span class="sc">?A</span><span class="o">+</span><span class="n">width</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">chr</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="vi">@name</span><span class="o">=</span><span class="s2">&quot;Base-</span><span class="si">#{</span><span class="n">pole</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@move_count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nb">self</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">to_s</span>
</span><span class='line'>    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="vi">@name</span><span class="si">}</span><span class="s2">(</span><span class="si">#{</span><span class="vi">@pole</span><span class="si">}</span><span class="s2">,</span><span class="si">#{</span><span class="vi">@move_count</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="c1">#{@@the_towers}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">move_upon</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
</span><span class='line'>    <span class="vc">@@the_towers</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="nb">self</span><span class="si">}</span><span class="s2"> moved </span><span class="si">#{</span><span class="vi">@pole</span><span class="o">.</span><span class="n">to_s</span><span class="si">}</span><span class="s2"> -&gt; </span><span class="si">#{</span><span class="n">destination</span><span class="o">.</span><span class="n">pole</span><span class="o">.</span><span class="n">to_s</span><span class="si">}</span><span class="s2">  (</span><span class="si">#{</span><span class="n">destination</span><span class="o">.</span><span class="n">to_s</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@pole</span> <span class="o">=</span> <span class="n">destination</span><span class="o">.</span><span class="n">pole</span>
</span><span class='line'>    <span class="vi">@move_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h4>AnimatedTowerOfHanoi</h4>

<p>Now we are finally to the new &#8220;animated&#8221; class.  The main changes for this class are to enable it to talk to an owning &#8216;application&#8217; if it exists and also it starts hooking into the Shoes code.  For convenience, I made the behavior of the class branch based on whether that &#8216;@app&#8217; exists.  The final change is that AnimatedHanoiDisk does a sleep so we can see the animation.  This affects both console and graphic behavior.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">AnimatedTowerOfHanoi</span> <span class="o">&lt;</span> <span class="no">ModeledTowerOfHanoi</span>
</span><span class='line'>  <span class="kp">attr_reader</span> <span class="ss">:stacks</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initApp</span><span class="p">(</span><span class="n">shoesApp</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@app</span> <span class="o">=</span> <span class="n">shoesApp</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nb">self</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">setup_disks</span>
</span><span class='line'>    <span class="k">super</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@app</span><span class="o">.</span><span class="n">noteChange</span> <span class="k">if</span> <span class="vi">@app</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">createDisk</span><span class="p">()</span>
</span><span class='line'>    <span class="k">return</span> <span class="no">AnimatedHanoiDisk</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">ask_for_height</span>
</span><span class='line'>    <span class="vi">@height</span> <span class="o">=</span> <span class="mi">5</span>
</span><span class='line'>    <span class="k">return</span> <span class="kp">nil</span> <span class="k">unless</span> <span class="vi">@app</span>
</span><span class='line'>    <span class="n">answer</span> <span class="n">ask</span><span class="p">(</span><span class="s2">&quot;How Tall A Tower?&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">answer</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@height</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">to_i</span>
</span><span class='line'>    <span class="vi">@app</span><span class="o">.</span><span class="n">answer</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="n">outString</span><span class="p">)</span>
</span><span class='line'>    <span class="k">super</span> <span class="k">unless</span> <span class="vi">@app</span>
</span><span class='line'>    <span class="vi">@app</span><span class="o">.</span><span class="n">appendLog</span><span class="p">(</span><span class="n">outString</span><span class="p">)</span> <span class="k">if</span> <span class="vi">@app</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">move_disk</span><span class="p">(</span><span class="n">fromPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">)</span>
</span><span class='line'>    <span class="k">super</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@app</span><span class="o">.</span><span class="n">noteChange</span> <span class="k">if</span> <span class="vi">@app</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">AnimatedHanoiDisk</span> <span class="o">&lt;</span> <span class="no">HanoiDisk</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">move_upon</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
</span><span class='line'>    <span class="k">super</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">sleep</span> <span class="mi">0</span><span class="o">.</span><span class="mi">3</span>
</span><span class='line'>    <span class="c1">#@@the_towers.log(&quot;Foo&quot;)</span>
</span><span class='line'>    <span class="c1">#@@the_towers.draw_board</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Running via &#8216;irb&#8217;</h3>

<p>You can test the above code by running it in the normal Ruby console</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">AnimatedTowerOfHanoi</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">hanoi</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Putting on the Shoes</h3>

<p>If you have Shoes running successfully, you can combine the above code with a Shoes app which visualizes the state of the towers.  The Shoes code is:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Shoes</span><span class="o">.</span><span class="n">app</span> <span class="ss">:width</span> <span class="o">=&gt;</span> <span class="mi">520</span><span class="p">,</span> <span class="ss">:height</span> <span class="o">=&gt;</span> <span class="mi">600</span><span class="p">,</span> <span class="ss">:resizable</span> <span class="o">=&gt;</span> <span class="kp">false</span> <span class="k">do</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">answer</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@answer</span><span class="o">.</span><span class="n">replace</span> <span class="s2">&quot;Doing a </span><span class="si">#{</span><span class="n">v</span><span class="si">}</span><span class="s2"> story Hanoi&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">appendLog</span><span class="p">(</span><span class="n">outString</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@log</span><span class="o">.</span><span class="n">append</span> <span class="p">{</span> <span class="n">para</span> <span class="n">outString</span> <span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">noteChange</span>
</span><span class='line'>    <span class="n">redrawStacks</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">#redraw the stacks by simply clearing the area and drawing them again</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">redrawStacks</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@render_area</span><span class="o">.</span><span class="n">clear</span> <span class="k">do</span>
</span><span class='line'>      <span class="vi">@towerOfHanoi</span><span class="o">.</span><span class="n">stacks</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">eachStack</span><span class="p">,</span><span class="n">i</span><span class="o">|</span>
</span><span class='line'>        <span class="n">poleCenterX</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="mi">100</span> <span class="o">+</span> <span class="mi">50</span>
</span><span class='line'>
</span><span class='line'>        <span class="n">eachStack</span><span class="o">.</span><span class="n">each_with_index</span> <span class="k">do</span> <span class="o">|</span><span class="n">eachDisk</span><span class="p">,</span><span class="n">j</span><span class="o">|</span>
</span><span class='line'>          <span class="n">height</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">-</span> <span class="p">(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">15</span><span class="p">)</span>
</span><span class='line'>          <span class="n">width</span> <span class="o">=</span> <span class="n">eachDisk</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mi">10</span>
</span><span class='line'>
</span><span class='line'>          <span class="n">fill</span> <span class="s2">&quot;#A00&quot;</span>
</span><span class='line'>          <span class="n">rect</span><span class="p">(</span><span class="n">poleCenterX</span> <span class="o">-</span> <span class="n">width</span><span class="o">/</span><span class="mi">2</span> <span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span><span class='line'>          <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">#=============================================</span>
</span><span class='line'>
</span><span class='line'>  <span class="vi">@hanoiArea</span> <span class="o">=</span> <span class="n">stack</span> <span class="k">do</span>
</span><span class='line'>    <span class="vi">@answer</span> <span class="o">=</span> <span class="n">para</span> <span class="s2">&quot;Answers appear here&quot;</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@render_area</span> <span class="o">=</span> <span class="n">flow</span> <span class="ss">:width</span> <span class="o">=&gt;</span> <span class="mi">300</span><span class="p">,</span> <span class="ss">:height</span> <span class="o">=&gt;</span> <span class="mi">200</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">background</span> <span class="s2">&quot;#999&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="vi">@log</span> <span class="o">=</span> <span class="n">stack</span>
</span><span class='line'>
</span><span class='line'>  <span class="vi">@towerOfHanoi</span> <span class="o">=</span> <span class="no">AnimatedTowerOfHanoi</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">initApp</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span>
</span><span class='line'>  <span class="no">Thread</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span>
</span><span class='line'>    <span class="vi">@towerOfHanoi</span><span class="o">.</span><span class="n">hanoi</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The Shoes app has the main drawing area at the top and then a logging area beneath it.  The HanoiStacks are cleared and redrawn any time they change.  The original Smalltalk code used deltas (disks were moved individually) but that didn&#8217;t seem critical to match, and partially the code is relying on being on a black-and-white screen.</p>

<h3>Comments</h3>

<p>Not having a standard Graphics capability is not surprising or a problem for a scripting language (limited in context of usage) but is quite a problem for a language that wants to be mainstream.  There is a similar problem on the server-side with a standard (off-screen) image processing.  Shoes and RMagick and the like are trying to fill these holes but Ruby has been around for a long time for these aspects to not be addressed and part of the standard.</p>

<p>In terms of the resulting code with Shoes, the Ruby version is certainly nice and clean.</p>

<h3>Where Next?</h3>

<p>The last code-changing chapter deals with making the Algorithm a little more human-natural.  If people are interested, I may do that change too.  But comparatively it is a pretty minor change and does not bring out any interesting language aspects.</p>

<h3></h3>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/08/29/a-taste-of-ruby-part-4/">A Taste of Ruby (Part 4)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-29T02:53:00-07:00" pubdate data-updated="true">Aug 29<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is a multi-part series. The first in the series is <a href="../2008-08-28/a-taste-of-ruby">here</a>.</p>

<h2>Tower of Hanoi — With Model Objects</h2>

<p>The book &#8220;A Taste of Smalltalk&#8221; jumps from showing a single &#8216;TowerOfHanoi&#8217; object to both adding in Disk model objects and putting on a graphical representation of those Disk objects.  Given Ruby has no built-in graphic capability, I want to separate these two changes.  So first we can put in Disk objects and study that change.  This should work for anyone with a Ruby installation and does not require installing Tk or Shoes or anything.  After that, we can go into some GUI toolkit code just to finish up the comparison and have bonus points.</p>

<p>To make the adding of Disk objects to our Hanoi code a bit more &#8216;realistic&#8217;, a new bonus requirement (beyond the book) is that we track the number of times a given disk moves.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># A ModeledTowerOfHanoi is the TowerOfHanoi algorithm</span>
</span><span class='line'><span class="c1"># but it keeps track of the state of the Disks</span>
</span><span class='line'><span class="c1"># with actual objects.  This makes it suitable for</span>
</span><span class='line'><span class="c1"># model-based behavior (say tracking moves, animation or</span>
</span><span class='line'><span class="c1"># other event listening) on top of those Disks</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">ModeledTowerOfHanoi</span> <span class="o">&lt;</span> <span class="no">TowerOfHanoi</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">hanoi</span>
</span><span class='line'>    <span class="n">ask_for_height</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">setup_disks</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;Start&quot;</span>
</span><span class='line'>    <span class="n">print_stacks</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">puts</span>
</span><span class='line'>    <span class="n">move_tower</span><span class="p">(</span><span class="vi">@height</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">puts</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;Result&quot;</span>
</span><span class='line'>    <span class="n">print_stacks</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">print_stacks</span>
</span><span class='line'>    <span class="vi">@stacks</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span> <span class="n">eachStack</span> <span class="o">|</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s2">&quot;  &quot;</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="n">eachStack</span><span class="o">.</span><span class="n">reverse</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s2">&quot;  &quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">ask_for_height</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;How tall a tower?&quot;</span>
</span><span class='line'>    <span class="nb">print</span> <span class="s2">&quot;&gt;&quot;</span>
</span><span class='line'>    <span class="n">height</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1">#gets.to_i</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>    <span class="vi">@height</span> <span class="o">=</span> <span class="n">height</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">setup_disks</span>
</span><span class='line'>    <span class="no">HanoiDisk</span><span class="o">.</span><span class="n">set_towers</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@stacks</span> <span class="o">=</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span> <span class="p">}</span>
</span><span class='line'>    <span class="n">firstStack</span> <span class="o">=</span> <span class="vi">@stacks</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
</span><span class='line'>    <span class="mi">1</span><span class="o">.</span><span class="n">upto</span><span class="p">(</span><span class="vi">@height</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">size</span><span class="o">|</span>
</span><span class='line'>      <span class="n">disk</span> <span class="o">=</span> <span class="no">HanoiDisk</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">initWidth_pole</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="n">firstStack</span><span class="o">.</span><span class="n">unshift</span><span class="p">(</span><span class="n">disk</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@mockDisks</span> <span class="o">=</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span><span class='line'>    <span class="mi">1</span><span class="o">.</span><span class="n">upto</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
</span><span class='line'>      <span class="vi">@mockDisks</span><span class="o">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">]=</span><span class="p">(</span><span class="no">HanoiDisk</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">initWidth_pole</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="n">i</span><span class="p">))</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">move_disk</span><span class="p">(</span><span class="n">fromPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">supportDisk</span> <span class="o">=</span> <span class="k">if</span> <span class="p">(</span><span class="vi">@stacks</span><span class="o">[</span><span class="n">toPin</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">empty?</span><span class="p">)</span> <span class="k">then</span>
</span><span class='line'>      <span class="vi">@mockDisks</span><span class="o">[</span><span class="n">toPin</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="vi">@stacks</span><span class="o">[</span><span class="n">toPin</span><span class="o">-</span><span class="mi">1</span><span class="o">][</span><span class="mi">0</span><span class="o">]</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">disk</span> <span class="o">=</span> <span class="vi">@stacks</span><span class="o">[</span><span class="n">fromPin</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">pop</span>
</span><span class='line'>    <span class="vi">@stacks</span><span class="o">[</span><span class="n">toPin</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">push</span><span class="p">(</span><span class="n">disk</span><span class="p">)</span>
</span><span class='line'>    <span class="n">disk</span><span class="o">.</span><span class="n">move_upon</span><span class="p">(</span><span class="n">supportDisk</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="nb">print</span> <span class="n">disk</span><span class="p">,</span> <span class="s2">&quot; moved &quot;</span><span class="p">,</span> <span class="n">fromPin</span><span class="o">.</span><span class="n">to_s</span><span class="p">,</span> <span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">toPin</span><span class="o">.</span><span class="n">to_s</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">HanoiDisk</span>
</span><span class='line'>  <span class="kp">attr_reader</span> <span class="ss">:name</span>
</span><span class='line'>  <span class="kp">attr_reader</span> <span class="ss">:pole</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">set_towers</span><span class="p">(</span><span class="n">owner</span><span class="p">)</span>
</span><span class='line'>    <span class="vc">@@the_towers</span> <span class="o">=</span> <span class="n">owner</span>
</span><span class='line'>    <span class="vc">@@the_thickness</span> <span class="o">=</span> <span class="mi">14</span>
</span><span class='line'>    <span class="vc">@@the_diskgap</span> <span class="o">=</span> <span class="mi">2</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initWidth_pole</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">pole</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@pole</span> <span class="o">=</span> <span class="n">pole</span>
</span><span class='line'>    <span class="vi">@width</span> <span class="o">=</span> <span class="n">width</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">width</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">)</span> <span class="k">then</span>
</span><span class='line'>      <span class="vi">@name</span><span class="o">=</span><span class="s2">&quot;Disk-</span><span class="si">#{</span><span class="p">(</span><span class="sc">?A</span><span class="o">+</span><span class="n">width</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">chr</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="vi">@name</span><span class="o">=</span><span class="s2">&quot;Base-</span><span class="si">#{</span><span class="n">pole</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@move_count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nb">self</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">to_s</span>
</span><span class='line'>    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="vi">@name</span><span class="si">}</span><span class="s2">(</span><span class="si">#{</span><span class="vi">@move_count</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">move_upon</span><span class="p">(</span><span class="n">destination</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@pole</span> <span class="o">=</span> <span class="n">destination</span><span class="o">.</span><span class="n">pole</span>
</span><span class='line'>    <span class="vi">@move_count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="no">ModeledTowerOfHanoi</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">hanoi</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now things are somewhat interesting for comparison purposes.  With the new class &#8216;HanoiDisk&#8217;, we have:</p>

<ol>
<li><p>Public Attribute macros</p></li>
<li><p>Explicit return values</p></li>
<li><p>Class Object behavior (&#8216;set_towers&#8217;)</p></li>
</ol>


<h3>Macros</h3>

<p>Of these topics, I think the &#8216;macros&#8217; is the more interesting.  I have another post on &#8216;Being Ephemeral&#8217; which quickly distills the concept, but Ruby (and Lisp before it) gets it right in that program generation (in a controlled fashion) is more powerful than having static programs.  The problem with Smalltalk <em>in its common usage</em> is that people want the image to be mostly static.  But the image is the expansion of all these macros (Smalltalk can have macros as easily as Lisp can) &#8211; and so people are saying that macros must be developer tools (like the Refactoring tools) vs. taking you a level above.  But if you expand the macro and record <em>the results</em> you have lost the value of the macro from that point forward.  If Smalltalk execution environments would accept giving up the image (a snapshot of all previous expansions), it would be more capable than it is.  There is nothing in the language that prevents this, but the execution environments discourage going down this path.</p>

<p>It is purely a &#8216;what is the source&#8217; question.  The Smalltalk equivalent of &#8216;attr_reader&#8217; is simply:</p>

<ul>
<li>HanoiDisk attrReader: #name</li>
</ul>


<p>Seriously&#8230; it would be that short and sweet.  But unless the source of a running application is something other than the image, that line would never be executed.</p>

<p>This is a problem in a totally different-sounding but very similar area: Virtualized Computers (Xen, VMWare).  Snapshotting the &#8216;image&#8217; of a virtualized computer sounds cool &#8211; but it immediately causes you lots of havoc.  What if you need to upgrade just one thing in the Snapshot? &#8230; it could be a real head-ache to uninstall and reinstall a new MySQL and is not as simple as &#8216;yum install&#8217;.  And if you are doing the Kernel itself, you are totally hosed.  The better approach is to treat the virtualized computer as ephemeral, have scripts in a higher-level-language to rebuild it at any time, and then the only use of a snapshot is to make rebuilding it faster.  A snapshould should just be a cache of the built system vs. the system-of-record for what you want to run.</p>

<h3>Explicit return values</h3>

<p>What should a method return if not otherwise stated?  The right answer is &#8216;nil&#8217;.  Why?  Because it is the right answer :-)  Actually, it is because the return value of a method may need to be non-trivially transmitted to the caller message.  Specifically the caller of a remote message.  So you want the return value to be as light-weight as possibly by default.  &#8216;nil&#8217; fits that bill.  Smalltalk gets this wrong but was long-before client-server issues made the problem rear its head, so it gets a pass.</p>

<p>OK&#8230; you don&#8217;t like that answer.  The next &#8216;almost right&#8217; answer is &#8216;self&#8217;. Why?  Well, what else could possibly make sense?  I didn&#8217;t say what to return, so just return me.  And this is almost as lightweight as &#8216;nil&#8217; (but not quite).</p>

<p>Just because something is on the last line of a method, in <em>no way</em> indicates it is meant to be sent back to the caller.  For example, ending with:</p>

<ul>
<li>really_huge_and_private_object.do_some_command_that_happens_to_return_self</li>
</ul>


<p>does not in any way convey I intend to send &#8216;really_huge_and_private_object&#8217; back to the caller.  As far as I stated&#8230; I don&#8217;t want to send anything back to the caller.  I should have to say that I want to do something before the program just &#8216;guesses&#8217; I want to do something I don&#8217;t want to do.  Basically just guesses that whatever happens to be on the stack should be passed back to the caller.  Serious encapsulation breakage.  And I shouldn&#8217;t have to say something like &#8216;return self&#8217; to prevent the program from making that obnoxious guess.</p>

<p>Given the Smalltalk equivalent of a return declaration is a single character (&#8217;<sup>&#8217;)</sup> (not too hard to type), and completely reveals the intent of the coder, the fact that Ruby chose neither of the above two variations of plausibly right answers is just bizarre and a source of errors.</p>

<h3>Class Object behavior</h3>

<p>The concept here is clean enough and the notation for Class Variables is nicely clean (and partially helps separate &#8216;Class Variables&#8217; from &#8216;Class Instance Variables&#8217;).  I think &#8216;def self&#8217; is less readable than &#8216;class.def&#8217; (defining for the HanoiDisk.class vs. HanoiDisk), but that presumes that keywords like &#8216;def&#8217; could be more easily understood as messages to classes (a &#8216;Turtles all the way down&#8217; concept) as I wrote earlier.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/08/29/a-taste-of-ruby-part-3/">A Taste of Ruby (Part 3)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-29T00:27:00-07:00" pubdate data-updated="true">Aug 29<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is a multi-part series.  The first in the series is <a href="../2008-08-28/a-taste-of-ruby">here</a>.</p>

<h2>Tower of Hanoi &#8211; With A Real Object</h2>

<p>The first two examples were not really object-based.  They are purely procedural, the algorithm is expressed completely recursively, and execution state is maintained on the call stack.  This works fine if we are just &#8216;tracing&#8217; the algorithm, but it does not let us show the state of the towers at any given time.  We also don&#8217;t see much in the way of real objects.  By adding the state of the towers in, we now have a reason to have stateful objects and new Classes of objects to maintain that state.  The added code with some explanation is in Chapter 4, Page 45.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># A Taste of Ruby.  Based on a Taste of Smalltalk (Kaehler and Patterson)</span>
</span><span class='line'><span class="c1"># Tower of Hanoi -- Variation 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># TowerOfHanoi</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="c1"># @stacks is an Array of DiskHolders (pins)</span>
</span><span class='line'><span class="k">class</span> <span class="nc">TowerOfHanoi</span> <span class="o">&lt;</span> <span class="no">Object</span>
</span><span class='line'>  <span class="c1">#Tower of Hanoi program.</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">hanoi</span>
</span><span class='line'>    <span class="c1"># Do the tower</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;How tall a tower?&quot;</span>
</span><span class='line'>    <span class="nb">print</span> <span class="s2">&quot;&gt;&quot;</span>
</span><span class='line'>    <span class="n">height</span> <span class="o">=</span> <span class="nb">gets</span><span class="o">.</span><span class="n">to_i</span>
</span><span class='line'>
</span><span class='line'>    <span class="vi">@stacks</span> <span class="o">=</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">collect</span> <span class="p">{</span> <span class="nb">Array</span><span class="o">.</span><span class="n">new</span> <span class="p">}</span>
</span><span class='line'>    <span class="n">firstStack</span> <span class="o">=</span> <span class="vi">@stacks</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
</span><span class='line'>    <span class="mi">1</span><span class="o">.</span><span class="n">upto</span><span class="p">(</span><span class="n">height</span><span class="p">)</span> <span class="p">{</span><span class="o">|</span><span class="n">i</span><span class="o">|</span> <span class="n">firstStack</span><span class="o">.</span><span class="n">unshift</span><span class="p">(</span><span class="s2">&quot;Disk-</span><span class="si">#{</span><span class="p">(</span><span class="sc">?A</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">chr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">move_tower</span><span class="p">(</span><span class="n">height</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Recursive procedure to move the disk at a height</span>
</span><span class='line'>  <span class="c1"># from one pin to another pin using a third pin</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">move_tower</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">fromPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">,</span> <span class="n">usingPin</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">height</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
</span><span class='line'>      <span class="n">move_tower</span><span class="p">(</span><span class="n">height</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">fromPin</span><span class="p">,</span> <span class="n">usingPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">)</span>
</span><span class='line'>      <span class="n">move_disk</span><span class="p">(</span><span class="n">fromPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">)</span>
</span><span class='line'>      <span class="n">move_tower</span><span class="p">(</span><span class="n">height</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">usingPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">,</span> <span class="n">fromPin</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Actually move the disk between the pins</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">move_disk</span><span class="p">(</span><span class="n">fromPin</span><span class="p">,</span><span class="n">toPin</span><span class="p">)</span>
</span><span class='line'>    <span class="n">disk</span> <span class="o">=</span> <span class="p">(</span><span class="vi">@stacks</span><span class="o">[</span><span class="n">fromPin</span><span class="o">-</span><span class="mi">1</span><span class="o">]</span><span class="p">)</span><span class="o">.</span><span class="n">pop</span>
</span><span class='line'>    <span class="vi">@stacks</span><span class="o">[</span><span class="n">toPin</span><span class="o">-</span><span class="mi">1</span><span class="o">].</span><span class="n">push</span><span class="p">(</span><span class="n">disk</span><span class="p">)</span>
</span><span class='line'>    <span class="nb">print</span> <span class="n">disk</span><span class="p">,</span> <span class="s2">&quot; moved &quot;</span><span class="p">,</span> <span class="n">fromPin</span><span class="o">.</span><span class="n">to_s</span><span class="p">,</span> <span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">toPin</span><span class="o">.</span><span class="n">to_s</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="no">TowerOfHanoi</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">hanoi</span>
</span></code></pre></td></tr></table></div></figure>


<p>So we moved to adding state to an object by simply referencing an instance variable (notationally via the &#8216;@&#8217;).  Again, I find that unpleasant and would rather the compiler (and human reader) was told a bit more formally what instance variables exist.  In quickly typing the above, I made a typo (&#8220;@stack&#8221;) that caused a runtime error and should have been easily detected at compile time.</p>

<p>Comparing with Smalltalk, the similarities are extremely high again.  Basically the core method calls and flow (e.g. the bytecodes) would look almost identical and it is only syntactic differences (built-in keywords in Ruby, shortening of selectors/method-names, etc.) that make the two read differently.  The idioms can be maintained (1.upto(height)) during translation and both versions are natural for their own language.  There is no paradigm change, impedance mismatch, etc.</p>

<h3>Where Next?</h3>

<p>Next we should go to Chapter 5 (Animating the Program) — Page 64.  This involves some graphic work for the &#8216;model&#8217; aspects to be realistic, so I guess I will go into the Tk toolkit or Shoes as among the easiest Ruby graphic extensions to use as an example.  If anyone has suggestions for other ones (meant to be super simple), please let me know.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/08/29/a-taste-of-ruby-part-2/">A Taste of Ruby (Part 2)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-29T00:08:00-07:00" pubdate data-updated="true">Aug 29<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is a multi-part series.  The first in the series is <a href="../2008-08-28/a-taste-of-ruby">here</a>.</p>

<h2>Tower of Hanoi &#8211; Procedural With Input</h2>

<p>The second example from &#8220;A Taste of Smalltalk&#8221; is in Chapter 3, page 36 and does basic IO.  Except that Smalltalk-80 includes a Windowing graphics system so it can automatically open Dialogs and other things.  Smalltalk (started in 1972) was one of the environments that <em>created</em> personal computers and included abilities in its VM and Libraries that are now submerged into the operating system (some 30 years later).  Now that these abilities are &#8216;intrisically&#8217; present, there are many different ways to access them &#8211; so Ruby does not include graphics itself (in its own terms) but calls extensions that provide those graphics.  Given I don&#8217;t really want to go into Tk or Web programming when discussing a language itself, I will simplify the problem and make it so we only need to get the value somehow&#8230; So &#8216;gets&#8217; is fine.</p>

<h3>Tower of Hanoi &#8211; Procedural with Input &#8211; Ruby</h3>

<p>The only thing we need to do is get the height from the user, so we can just ask for it:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Do the tower</span>
</span><span class='line'><span class="nb">puts</span> <span class="s2">&quot;How tall a tower?&quot;</span>
</span><span class='line'><span class="nb">print</span> <span class="s2">&quot;&gt;&quot;</span>
</span><span class='line'><span class="n">height</span> <span class="o">=</span> <span class="nb">gets</span>
</span><span class='line'><span class="n">move_tower</span><span class="p">(</span><span class="n">height</span><span class="o">.</span><span class="n">to_i</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Quite simple and probably the only interesting thing is that &#8216;height&#8217; did not need to be declared at all.  Personally I find this <em>unpleasant</em> and bad for system stability, but I can see the convenience of it.  I would rather Ruby had a way to formally declare local variables, instance variables, etc. and in a &#8216;strict&#8217; mode would give feedback.</p>

<p>Smalltalk does formally declare variables, so it is more compile-time checked than Ruby.  The Smalltalk IDEs also warn about things in a way that usually avoids typos, but that is not part of the language itself.  But I would think the simplicity of the syntax and programming model makes the Smalltalk compiler much easier to write and optimize, but that is just an impression.</p>

<h3>Where Next?</h3>

<p>Next we should go to Chapter 4 — Page 44. The Third Example (with Real Hanoi Classes)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/08/28/a-taste-of-ruby/">A Taste of Ruby</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-28T18:00:00-07:00" pubdate data-updated="true">Aug 28<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>One of my favored books in the 1980s was &#8216;A Taste of Smalltalk&#8217;.  This was a very short book that gave you the flavor of Smalltalk programming (the language and IDE) as compared to Pascal, C, and Lisp.  I believe it is always important to show multiple programming languages for concepts and this book followed that rule.  The goal of this post-series is to take &#8216;A Taste of Smalltalk&#8217; and apply it to Ruby.</p>

<p>You can find the original book here:</p>

<ul>
<li><a href="http://www.iam.unibe.ch/~ducasse/FreeBooks/Taste/">A Taste of Smalltalk</a></li>
<li><a href="http://stephane.ducasse.free.fr/FreeBooks.html">Free Smalltalk Books</a></li>
</ul>


<p>Given the original book is available online, I will not repeat it.</p>

<p>You should have a Ruby interpreter, which you can find at <a href="http://www.ruby-lang.org/">http://www.ruby-lang.org/</a> or it may already be on your computer.  The code examples should work pasted directly into &#8216;irb&#8217;.</p>

<p>For playing with Smalltalk, you can pick up Squeak from <a href="http://squeak.org/">http://squeak.org/</a>.  Squeak&#8217;s UI is a bit different from Smalltalk-80 (in the book), but if you go through a quick Squeak tutorial, you should be able to connect the two.</p>

<h2>Tower of Hanoi &#8211; Procedural</h2>

<p>The first example in &#8216;A Taste&#8217; is in multiple languages (Chapter 1).  This is Tower of Hanoi done totally procedurally.  Converting to Ruby is very simple and clean:</p>

<h3>Tower of Hanoi &#8211; Procedural &#8211; Ruby</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># A Taste of Ruby.  Based on a Taste of Smalltalk (Kaehler and Patterson)</span>
</span><span class='line'><span class="c1"># Tower of Hanoi -- Variation 1</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Recursive procedure to move the disk at a height</span>
</span><span class='line'><span class="c1"># from one pin to another pin using a third pin</span>
</span><span class='line'><span class="k">def</span> <span class="nf">move_tower</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">fromPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">,</span> <span class="n">usingPin</span><span class="p">)</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">height</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
</span><span class='line'>    <span class="n">move_tower</span><span class="p">(</span><span class="n">height</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">fromPin</span><span class="p">,</span> <span class="n">usingPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">)</span>
</span><span class='line'>    <span class="n">move_disk</span><span class="p">(</span><span class="n">fromPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">)</span>
</span><span class='line'>    <span class="n">move_tower</span><span class="p">(</span><span class="n">height</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">usingPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">,</span> <span class="n">fromPin</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Actually move the disk between the pins</span>
</span><span class='line'><span class="k">def</span> <span class="nf">move_disk</span><span class="p">(</span><span class="n">fromPin</span><span class="p">,</span><span class="n">toPin</span><span class="p">)</span>
</span><span class='line'>  <span class="nb">print</span> <span class="n">fromPin</span><span class="o">.</span><span class="n">to_s</span><span class="p">,</span> <span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">toPin</span><span class="o">.</span><span class="n">to_s</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Do the tower</span>
</span><span class='line'><span class="n">move_tower</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>You could simply paste this into irb to see it run.</p>

<h3>Smalltalk without the IDE</h3>

<p>Some people (many people) consider Smalltalk to mandatorily include an IDE and that you _must _ use an IDE to create Smalltalk code and to run a Smalltalk application.  This is clearly not true and there are many examples of Smalltalk running without any IDE at all.  For example, GNU Smalltalk, Little Smalltalk, GemStone, and &#8216;Headless Smalltalk&#8217; (when you deploy VisualWorks you frequently strip the IDE code out) are all valid Smalltalks that do not have an IDE in themselves and if you wanted them to run a program, you would just &#8216;File it in&#8217; from a file.  I mention this because the next chapter of &#8220;A Taste of Smalltalk&#8221; shows the Smalltalk-80 IDE as the way to create the Smalltalk code.  If you download <a href="squeak.org">Squeak</a> you can follow fairly similar  steps to the one in the book.</p>

<p>To make inter-language comparisons easier, I will instead use the &#8216;File In&#8217; format when talking about Smalltalk programs.  Since that is missing from the book, here it is.  Note that the lines starting with &#8216;!&#8217; are not Smalltalk language syntax but are part of the standard library for being able to &#8216;file in&#8217; changes.  For most programming languages the two would be equivalent, but Smalltalk allows multiple ways of creating a program so the coupling is softer.</p>

<h3>Tower of Hanoi &#8211; Procedural &#8211; Smalltalk</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='smalltalk'><span class='line'>    !<span class="nc">Object</span> <span class="nf">methodsFor:</span> <span class="s">&#39;hanoi&#39;</span> <span class="nf">stamp:</span> <span class="s">&#39;MLF 8/28/2008 10:31&#39;</span><span class="nf">!</span>
</span><span class='line'>    <span class="nf">moveTower:</span> <span class="nv">height</span> <span class="nf">from:</span> <span class="nv">fromPin</span> <span class="nf">to:</span> <span class="nv">toPin</span> <span class="nf">using:</span> <span class="nv">usingPin</span>
</span><span class='line'>        (<span class="nv">height</span> <span class="nf">&gt;</span> <span class="m">0</span>) <span class="nb">ifTrue:</span> [
</span><span class='line'>          <span class="bp">self</span> <span class="nf">moveTower:</span> (<span class="nv">height</span><span class="nf">-</span><span class="m">1</span>) <span class="nf">from:</span> <span class="nv">fromPin</span> <span class="nf">to:</span> <span class="nv">usingPin</span> <span class="nf">using:</span> <span class="nv">toPin</span><span class="p">.</span>
</span><span class='line'>          <span class="bp">self</span> <span class="nf">moveDisk:</span> <span class="nv">fromPin</span> <span class="nf">to:</span> <span class="nv">toPin</span><span class="p">.</span>
</span><span class='line'>          <span class="bp">self</span> <span class="nf">moveTower:</span> (<span class="nv">height</span><span class="nf">-</span><span class="m">1</span>) <span class="nf">from:</span> <span class="nv">usingPin</span> <span class="nf">to:</span> <span class="nv">toPin</span> <span class="nf">using:</span> <span class="nv">fromPin</span>
</span><span class='line'>      ]
</span><span class='line'>    <span class="nf">!</span>
</span><span class='line'>
</span><span class='line'>    <span class="nf">moveDisk:</span> <span class="nv">fromPin</span> <span class="nf">to:</span> <span class="nv">toPin</span>
</span><span class='line'>      <span class="nc">Transcript</span> <span class="nf">show:</span> (<span class="nv">fromPin</span> <span class="nf">printString,</span> <span class="s">&#39; -&gt; &#39;</span><span class="nf">,</span> <span class="nv">toPin</span> <span class="nf">printString</span>)<span class="p">;</span> <span class="nf">cr</span><span class="p">.</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">! !</span>
</span><span class='line'>
</span><span class='line'>    <span class="err">&quot;</span><span class="nc">Do</span> <span class="nf">the</span> <span class="nf">tower</span>
</span><span class='line'>    (<span class="nc">Object</span> <span class="nb">new</span>) <span class="nf">moveTower:</span> <span class="m">3</span> <span class="nf">from:</span> <span class="m">1</span> <span class="nf">to:</span> <span class="m">3</span> <span class="nf">using:</span> <span class="m">2</span>
</span><span class='line'>    <span class="nf">!</span>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>


<p>Now an interesting thing about the Smalltalk version is that we had to create an object to execute our code.  Smalltalk does not have functions or procedures: it only has objects and messages that get sent to objects.  So we need some object to respond to the message.  There could be an implicit object associated with the &#8216;File In&#8217; format &#8211; but there isn&#8217;t.  A second interesting thing about the Smalltalk version is that we modified Object itself.  So any of:</p>

<ul>
<li><p>&#8216;Foo&#8217; moveTower: 3 from: 1 to: 3 using: 2</p></li>
<li><p>3 moveTower: 3 from: 1 to: 3 using: 2</p></li>
<li><p>false moveTower: 3 from: 1 to: 3 using: 2</p></li>
<li><p>nil moveTower: 3 from: 1 to: 3 using: 2</p></li>
</ul>


<p>would work.  So because we modified Object and there are well known objects of type Object (and descendants) in the system, we didn&#8217;t have to actually create an Object at all.</p>

<h3>Ruby is cleaner</h3>

<p>In this particular case, Ruby is:</p>

<ul>
<li>Doing a much cleaner thing by default (for this file-in approach)</li>
<li>But can do exactly the same thing if told to</li>
</ul>


<p>The &#8220;cleaner thing by default&#8221; is that Ruby statements (commands) when being executed are always talking to some object, and the default object is an object called &#8216;main&#8217;.  So statements without an explicit object <em>receiving</em> the message send those messages to &#8216;main&#8217; &#8211; and the message &#8220;move_tower&#8221; is sent to main.  And although Ruby doesn&#8217;t describe itself quite like this, effectively &#8216;def&#8217; could be viewed as a message and it is also sent to &#8216;main&#8217;.  &#8216;def&#8217; creates a method on a Class &#8211; either the eigen-class of the receiving object or on a Class object.  So Ruby behaves almost identically to Smalltalk except it:</p>

<ul>
<li>Has a default object for &#8216;File In&#8217; format</li>
<li>Creates methods on the eigen-class if a non-class is the target of the def &#8216;message&#8217;</li>
</ul>


<p>Probably the simplest way for Smalltalk to match this cleaner scripting approach is for a Smalltalk &#8216;terminal&#8217; (called IRS :-) to define &#8216;self&#8217; as being itself and then the method definitions would automatically happen on itself.  So you would have lines like:</p>

<ul>
<li>&#8216;!self methodsFor: &#8216;hanoi&#8217; &#8230;</li>
<li>self moveTower: 3 from: 1 &#8230;</li>
</ul>


<p>and applying to Object would no longer be necessary.  This &#8216;scripting&#8217; need has not been important to the Smalltalk community in general although someone may have something very like this.</p>

<h3>Ruby being a bit more Smalltalkish</h3>

<p>The second point above was that Ruby can do exactly what the Smalltalk code does.  This isn&#8217;t to show that this is a better approach (in this case it is not), but to show the incredible similarity between the two languages.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># A Taste of Ruby.  Based on a Taste of Smalltalk (Kaehler and Patterson)</span>
</span><span class='line'><span class="c1"># Tower of Hanoi -- Variation 1b</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">Object</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Recursive procedure to move the disk at a height</span>
</span><span class='line'><span class="c1"># from one pin to another pin using a third pin</span>
</span><span class='line'><span class="k">def</span> <span class="nf">move_tower</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">fromPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">,</span> <span class="n">usingPin</span><span class="p">)</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="n">height</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
</span><span class='line'>    <span class="n">move_tower</span><span class="p">(</span><span class="n">height</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">fromPin</span><span class="p">,</span> <span class="n">usingPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">)</span>
</span><span class='line'>    <span class="n">move_disk</span><span class="p">(</span><span class="n">fromPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">)</span>
</span><span class='line'>    <span class="n">move_tower</span><span class="p">(</span><span class="n">height</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">usingPin</span><span class="p">,</span> <span class="n">toPin</span><span class="p">,</span> <span class="n">fromPin</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Actually move the disk between the pins</span>
</span><span class='line'><span class="k">def</span> <span class="nf">move_disk</span><span class="p">(</span><span class="n">fromPin</span><span class="p">,</span><span class="n">toPin</span><span class="p">)</span>
</span><span class='line'>  <span class="nb">print</span> <span class="n">fromPin</span><span class="o">.</span><span class="n">to_s</span><span class="p">,</span> <span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">toPin</span><span class="o">.</span><span class="n">to_s</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Do the tower</span>
</span><span class='line'><span class="p">(</span><span class="no">Object</span><span class="o">.</span><span class="n">new</span><span class="p">)</span><span class="o">.</span><span class="n">move_tower</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span><span class='line'><span class="nb">puts</span> <span class="s2">&quot;---&quot;</span>
</span><span class='line'><span class="s2">&quot;HiThere&quot;</span><span class="o">.</span><span class="n">move_tower</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span><span class='line'><span class="nb">puts</span> <span class="s2">&quot;---&quot;</span>
</span><span class='line'><span class="kp">nil</span><span class="o">.</span><span class="n">move_tower</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>This similarity is way beyond casual similarity &#8211; enabling &#8216;nil&#8217; to have a method by augmenting Object with almost exactly the same incantation makes for a very similar DNA.  Basically it seems like the Ruby language is a pure syntactic mutation on Smalltalk.</p>

<h3>Fun with Ducks</h3>

<p>The term &#8220;Duck Typing&#8221; was not around in the 80s (AFAIK), but instead people talked about &#8216;Dynamic Typing&#8217; where the Duckness was hidden under that Dynamic-ness.  There are certainly other terms too (I used the term &#8216;protocol&#8217; where protocol was just obeying the required messages and semantics properly &#8211; i.e. acting like a Duck).  This Hanoi example has a nice Duck property &#8211; We don&#8217;t care what the stacks are as long as they can be converted to Strings:</p>

<pre><code>#Bizarre Hanoi Showing Duck Typing
move_tower(3,"Tower-1", nil, Proc.new {|| "Tower" })
</code></pre>

<h3>Tower of Hanoi &#8211; Procedural &#8211; Java</h3>

<p>For completeness, we should do the example in Java as well.  Given Java execution starts at some static &#8216;main&#8217; method/procedure, it seems like the most natural version of this Procedural code is to stay on that static side.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">class</span> <span class="nc">Hanoi</span> <span class="o">{</span>
</span><span class='line'>   <span class="kd">static</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">moveTower</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">2</span><span class="o">);</span>
</span><span class='line'>   <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>   <span class="kd">static</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">moveTower</span><span class="o">(</span><span class="kt">int</span> <span class="n">height</span><span class="o">,</span> <span class="n">Object</span> <span class="n">fromPin</span><span class="o">,</span> <span class="n">Object</span> <span class="n">toPin</span><span class="o">,</span> <span class="n">Object</span> <span class="n">usingPin</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="o">(</span><span class="n">height</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>         <span class="n">moveTower</span><span class="o">(</span><span class="n">height</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="n">fromPin</span><span class="o">,</span> <span class="n">usingPin</span><span class="o">,</span> <span class="n">toPin</span><span class="o">);</span>
</span><span class='line'>         <span class="n">moveDisk</span><span class="o">(</span><span class="n">fromPin</span><span class="o">,</span> <span class="n">toPin</span><span class="o">);</span>
</span><span class='line'>         <span class="n">moveTower</span><span class="o">(</span><span class="n">height</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="n">usingPin</span><span class="o">,</span> <span class="n">toPin</span><span class="o">,</span> <span class="n">fromPin</span><span class="o">);</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>   <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>   <span class="kd">static</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">moveDisk</span><span class="o">(</span><span class="n">Object</span> <span class="n">fromPin</span><span class="o">,</span> <span class="n">Object</span> <span class="n">toPin</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">+</span><span class="n">fromPin</span><span class="o">+</span><span class="s">&quot;-&gt;&quot;</span><span class="o">+</span><span class="n">toPin</span><span class="o">);</span>
</span><span class='line'>   <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Comments</h2>

<p>This example from &#8220;A Taste of Smalltalk&#8221; is the highly procedural version.  It is not meant to be a particularly good program, but it is a simple and good introductory example.  Because Ruby is an interpreter-oriented (scripting-oriented) language, it does quite well in making the example look simple and clean.  But even better (IMO) is that the developer has unknowingly shifted into a much more powerful programming model without any pain-of-entry.  I have never found Smalltalk to be hard but many people do and any barrier that prevents people from entering a community can harm both sides.</p>

<p>I believe the syntactic mutation in Ruby that hides an implicit object (&#8216;main&#8217;) actually helps tremendously with accessibility of the language.  It would only be a problem if the syntactic mutation later penalized the experienced developer.</p>

<h3>Logo, Turtles, and &#8216;main&#8217;</h3>

<p>I recently decided my daughters (4 and 7) might as well learn how to program, so I fired up a version of <a href="http://en.wikipedia.org/wiki/Logo_(programming_language">Logo</a>) for them to play with.  Logo has a pleasing characteristic where you are talking to a graphical Turtle by default &#8211; you can program the turtle by telling it what to do directly and can then start working your way up in programming sophistication.  The Ruby &#8216;main&#8217; seems to lend itself to the same thing.  You are by default talking to a (more boring :-) ) turtle, which makes the first level of accessibility easier.</p>

<p>At one point I wanted to test something quickly in Smalltalk and actually forgot what object I had to talk to to do a simple &#8216;print&#8217;.  Likewise with Java, &#8216;System.out&#8217; is extremely obscure.  The &#8216;Turtle&#8217; approach seems to help alleviate these kinds of issues a bit.</p>

<h3>Where Next?</h3>

<p>Next we should go to Chapter 3 &#8211; Page 36.  The Second Example.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2008/08/28/being-ephemeral/">Being Ephemeral</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-08-28T04:34:00-07:00" pubdate data-updated="true">Aug 28<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There are lots of topics in programming languages, IT infrastructure, and system design that turn out to be all about persistence vs. being ephemeral.  I don&#8217;t believe people realize it, but &#8220;being ephemeral&#8221; is the core question and the standard answer should be?  42.  Which given it is >0 is &#8216;Yes&#8217;.  So &#8220;Be Ephemeral&#8221; unless you can&#8217;t possibly be ephemeral.</p>

<p>When can&#8217;t you be ephemeral?&#8230; turns out it is in a very small number of cases.  Ruby is more ephemeral than the standard Smalltalk &#8216;image&#8217; approach, so it wins.  Xen/VMWare is more ephemeral than a physical machine, so it wins.  <em>Scripted</em> vm image building is more ephemeral than image snapshots, so its win.  Credit-card receipts in a retail store&#8230; well those have to be remembered (persistent) or you could lose money or customers or both.   So make that persistent :-)</p>

<p>Performance is always a consideration: &#8216;rebuilding&#8217; an image could be time-expensive, but the old adage [annotated] of:
   * Make it work (ephemerally if possible)
   * Make it right
   * Make it fast (pull the ephemerally <em>iff necessary</em>)
is the right approach.   You may be amazed at how ephemeral things can be.  NowUR built virtual desktop in less than 30 seconds &#8211; by being ephemeral.  An with Amazon EC2, for many things I can just plug in a script and have lots of &#8216;yummy&#8217; things happen in the same amount of time.</p>

<p>Why is &#8220;Being Ephemeral&#8221; right?  Well, there is one simple reason:
   * Inventory of outdated parts is very expensive (Theory Of Constraints, Lean Methods, etc.)</p>

<p>And if you can make it through the old adage without needing any Inventory, you have a better (less expensive, more agile, higher velocity) solution than someone that cheats by using Inventory.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/3/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p>
      <a href="http://www.linkedin.com/in/markfussell/">Linked In</a>
      &bull;
      <a href="http://github.com/markfussell/">Github</a>
      &bull;
      <a href="http://palobots.org/">PaloBots</a>
  </p>
    <!--
  <ul>
      <li><a href="http://www.linkedin.com/in/markfussell/">Linked In</a></li>
      <li><a href="http://github.com/markfussell/">Github</a></li>
      <li><a href="http://palobots.org/">PaloBots</a></li>
  </ul>
  &#8211;>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/01/13/git-about-everything-annex/">Being a git about everything (Annexing)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/11/git-about-everything-intro/">Being a git about everything (Intro)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2008/09/19/scratchonflash/">Scratch on Flash</a>
      </li>
    
      <li class="post">
        <a href="/blog/2008/09/17/scratch-textual-language/">Scratch Textual Language</a>
      </li>
    
      <li class="post">
        <a href="/blog/2008/09/08/a-taste-of-scratch/">A Taste of Scratch</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/markfussell">@markfussell</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'markfussell',
            count: 6,
            skip_forks: false,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>






  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Mark Fussell -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'markfussell';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
